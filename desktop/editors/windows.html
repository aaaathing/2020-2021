<!DOCTYPE html>
<!--
https://www.khanacademy.org/computer-programming/windows-10-simulator-with-json-filesystem/5017671751909376
########################################################
#######                                          #######
#######  I have stopped working on this project  #######
#######                                          #######
########################################################

Windows 10 Simulator with working file system

(working file system = endless possibilities)

all made by me :) one person!!!


**ALMOST ALL THE IMAGES (SVGs) WERE MADE BY ME (BY HAND)


Heres my profile url, for some reason my name under this project doesnt link to it :
https://www.khanacademy.org/profile/LiquidWaterH2O/projects






//----whtodo?
-- ZIP files
-- Send to
-- Properties
-- localStorage parse ma benaseb kol format
-- settings

-->

<html>

    <head>
        <meta charset="utf-8">
        <title>Windows 10 Simulator (With JSON Filesystem)</title>
        
        
        <style>
            
            *,
            *::before,
            *::after { 
                box-sizing: border-box;
            }
            
            html,body{ 
                margin:0;
                padding:0;
                overflow:hidden;
                height:100%;
            }
            body{ 
                --barh:30px; /*task-bar Height*/
                --appth:25px;/*Application-top Height*/
                
                background-image: url('https://www.kasandbox.org/programming-images/animals/fox.png');
                background-repeat:no-repeat;
                background-size:cover;
                background-attachment: fixed;
                font-family: Segoe UI, sans-serif;
            }
            svg{ 
                user-select:none;
                pointer-events: none;
            }
            
            .startup{ 
                position:absolute;
                background-color:black;
                width:100%;
                height:100%;
                z-index:1000;
                text-align:center;
                user-select:none;
            }
            .startuplogo{ 
                width:20%;
                max-width:150px;
                margin-top:70px;
            }
            .startupText{ 
                color:white;
                font-size:20px;
                margin:20px 0;
            }
            .startupChoose{ 
                display:flex;
                justify-content:center;
            }
            .startupButton{ 
                width:100px;
                margin:0 10px;
                border:2px solid rgb(179, 179, 179);
                background-color:rgb(245, 245, 245);
                border-radius:0;
                font-size:13px;
                cursor:pointer;
            }
            .startupButton:active{ 
                background-color:rgb(209, 209, 209);
                box-shadow:0 0 10px rgba(255, 255, 255, 0.5);
            }
            
            .loadingOS{ 
                white-space: pre-wrap;
                position:absolute;
                width:100%;
                height:100%;
                background-color:black;
                z-index:999;
                color:white;
                font-size:12px;
                font-family:monospace;
                padding-left:7px;
                overflow:auto;
            }
            .loadingOS *::selection{ 
                background-color:white;
                color:rgb(48, 48, 48);
            }
            
            
            #start-menu{ 
                display:none;
                height:0;
                width:auto;
                background-color:rgba(17, 17, 17,0.9);
                position:absolute;
                bottom:var(--barh);
                backdrop-filter: blur(5px);
                overflow-y:hidden;
                max-height:500px;
                width:40%;
                z-index:400;
            }
            #start-menu-cont{ 
                display:flex;
                user-select:none;
                height:100%;
            }
            #start-menu-apps, #start-menu-settings{ 
                overflow-y:auto;
            }
            #start-menu-cont ::-webkit-scrollbar { 
                width: 7px;
                height: 7px;
                background-color: transparent;
            }
            #start-menu-cont ::-webkit-scrollbar-track { 
                background-color: transparent;
            }
            #start-menu-cont ::-webkit-scrollbar-thumb { 
                background-color:rgba(255, 255, 255, 0.1);
                border-radius:7px;
            }
            
            .start-menu-apps-app{ 
                max-width:300px;
                padding:5px 8px;
                padding-right:50px;
                display:flex;
            }
            .start-menu-apps-icon svg{ 
                width:20px;
                height:20px;
            }
            .start-menu-apps-app:hover{ 
                background-color:rgba(255, 255, 255, 0.03);
            }
            .start-menu-apps-name{ 
                color: white;
                font-size:12px;
                white-space:nowrap;
                overflow:hidden;
                text-overflow:ellipsis;
                padding:0 4px;
            }
            
            #start-menu-settings{ 
                display:flex;
                flex-direction:column;
                height:100%;
                flex-flow:column-reverse;
            }
            .start-menu-settings-item{ 
                width:30px;
                height:30px;
                display:flex;
                align-items:center;
            }
            .start-menu-settings-item svg{ 
                display:block;
                margin:0 auto;
                width: 17px;
                height: 17px;
            }
            .start-menu-settings-item:hover{ 
                background-color:rgba(255, 255, 255, 0.1);
            }
            
            .icon{ 
                margin:auto;
                width:15px;
                height:15px;
            }
            
            
            .tooltip{ 
                background-color:rgb(243, 243, 243);
                padding:0px 4px;
                border:2px solid rgb(220, 220, 220);
                font-size:11px;
                display:inline-block;
                max-width:300px;
                user-select:none;
                z-index:10000;
            }
            
            
            .button-style:hover{ 
                background-color:rgba(255,255,255,0.17);
            }
            .button-style:active{ 
                background-color:rgba(255,255,255,0.25);
            }
            
            #WINDOWS{ 
                height:100%;
            }
            #desktop{ 
                width:100%;
                height:100%;
                user-select:none;
                display: flex;
                flex-wrap: wrap;
                align-content: flex-start;
                z-index:-1000;
            }
            .desktop-app{ 
                width:70px;
                height:70px;
                padding:5px;
            }
            .desktop-app > *{ 
                pointer-events:none;
            }
            .desktop-app-selected{ 
                background-color:rgb(0, 245, 255, 0.15);
                border: 1px solid rgb(0, 180, 255, 0.6);
            }
            .desktop-icon{ 
                margin:0 auto;
                width:45px;
                height:45px;
                display:flex;
                justify-content:center;
            }
            .desktop-icon svg{ 
                margin:0 auto;
                width:auto;
                height:45px;
            }
            
            .desktop-name{ 
                display:block;
                width:100%;
                text-align:center;
                font-size:11px;
                color:white;
                text-shadow:0 1px 3px black, 0 0 3px black, 0 0 3px black;
                overflow:hidden;
                white-space:nowrap;
                text-overflow:ellipsis;
            }
            
            
            /*       TASKBAR       */
            #task-bar{ 
                width:100%;
                height:var(--barh);
                background-color:rgba(17,17,17, 0.98);
                position:fixed;
                bottom:0;
                display:flex;
                z-index:300;
            }
            
            .task-bar-button{ 
                height:100%;
                width:30px;
                display: flex;
                align-items: center;
            }
            .task-bar-button-svg{ 
                margin:0 auto;
                padding:5px;
                display: flex;
            }
            .task-bar-button-svg svg{ 
                height:auto;
                width:100%;
            }
            .task-bar-button:hover{ 
                background-color:rgba(40, 40, 40, 0.98);
                transition:1s ease;
            }
            .task-bar-button:active{ 
                background-color:rgba(70, 70, 70, 0.98);
                transition:none;
            }
            .task-bar-view{ 
                position:absolute;
                width:auto;
                height:80px;
                background-color:rgba(51, 51, 51, 0.98);
                display:none;
                top: 0;
                opacity: 0;
                transform:translateY(calc(var(--barh) - 80px));
                display:flex;
                max-width:100%;
                padding:3px 3px 0 3px;
                box-shadow:0 0 10px rgba(0, 0, 0, 0.5);
            }
            .task-bar-view-app{ 
                width:100px;
                height:100%;
                display:flex;
                flex-direction:column;
                padding:1px 5px;
            }
            .task-bar-view-app:hover{ 
                border:1px solid rgba(255, 255, 255, 0.4);
                padding:0 4px;
                box-shadow:0 0 7px rgba(255, 255, 255, 0.3);
            }
            .task-bar-view-top{ 
                display:flex;
            }
            .task-bar-view-close{ 
                width:18px;
                height:15px;
                margin-left:auto;
                
            }
            .task-bar-view-close:hover{ 
                background-color:rgb(255, 255, 255, 0.1);
                cursor:pointer;
            }
            .task-bar-view-name{ 
                color:white;
                font-size:12px;
                white-space:nowrap;
                overflow:hidden;
                text-overflow:ellipsis;
            }
            .task-bar-view-bottom{ 
                width:100%;
                height:100%;
            }
            .task-bar-view-bottom-app{ 
                width:100%;
                height:95%;
                margin:0 auto;
                background-color:rgba(255,255,255,0.1);
            }
            
            
            /*--------------------*/
            
            
            
            /* APPLICATION-HOLDER */
            
            .application-holder{ 
                width:200px;
                height:200px;
                min-width:180px;
                min-height:80px;
                background-color:rgb(0, 99, 176);
                z-index:99;
                box-shadow: 0px 0px 5px rgba(0,0,0,0.3);
            }
            .application-holder-top{ 
                width:100%;
                height:var(--appth);
                display:flex;
            }
            .application-holder-top-name{ 
                font-size:12px;
                margin: 1px 0 0 5px;
                width:30%;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow:hidden;
            }
            .application-holder-top-button-holder{ 
                display:flex;
                margin-left:auto;
            }
            .application-holder-top-button{ 
                height:var(--appth);
                width:calc(var(--appth) + 3px);
            }
            
            .close-button:hover{ 
                background-color:rgb(232, 17, 35);
            }
            .close-button:active{ 
                background-color:rgb(240, 72, 88);
            }
            .app{ 
                position:relative;
                width:calc(100% - 4px);
                height:calc(100% - 2px - var(--appth));
                background-color:white;
                margin: auto;
                
                user-select:none;
            }
            
            .application-current{ 
                z-index:100;
            }
            
            /*--------------------*/
            
            /*    CONTEXT-MENU    */
            
            .contMenu-wrapper{ 
                position:absolute;
                background-color:rgb(245, 245, 245);
                margin:0;
                padding:0;
                width:auto;
                min-width:120px;
                
                box-shadow: 0px 0px 5px rgba(0,0,0,0.3);
                border:1px solid rgb(133, 131, 133);
                
                user-select:none;
                
                z-index:10000;
            }
            
            
            .contMenu-wrapper hr{ 
                border:1px solid rgb(222, 222, 222);
                width:90%;
                margin:1px auto;
            }
            
            
            .contMenu-item{ 
                
                display:flex;
                align-items:center;
                
                font-size:12px;
                margin:0;
                padding:2px 10px;
                color:rgb(23, 23, 23);
                
                overflow:hidden;
                white-space:nowrap;
                cursor:pointer;
            }
            .contMenu-item:hover{ 
                background-color:rgb(214, 214, 214);
            }
            
            
            .limit-contextMenu{ 
                position:fixed;
                max-height: 100%;
                overflow-y: scroll;
                top:100%;
            }
            
            /*--------------------*/
            
            
        </style>
        

    </head>
    <body>
    
        <div class="startup">
            <svg 
                class="startuplogo" viewBox="0 0 256 257" preserveAspectRatio="xMidYMid"><path d="M0 36.357L104.62 22.11l.045 100.914-104.57.595L0 36.358zm104.57 98.293l.08 101.002L.081 221.275l-.006-87.302 104.494.677zm12.682-114.405L255.968 0v121.74l-138.716 1.1V20.246zM256 135.6l-.033 121.191-138.716-19.578-.194-101.84L256 135.6z" fill="#fff"/></svg>
            <div class="startupText">Choose Startup Mode</div>
            <div class="startupChoose">
                <div class="startupButton startupButtonFull">Full Screen</div>
                <div class="startupButton startupButtonNorm">Normal</div>
            </div>
        </div><!--Startup-->
        <div class="loadingOS"></div><!--loadingOS-->
        
        <div id="WINDOWS">
        
            <div id="desktop"></div><!--Desktop-->
            <div id="start-menu">
                <div id="start-menu-cont">
                    <div id="start-menu-settings">
                        <div class="start-menu-settings-item start-menu-settings-power">
                            <svg viewBox='0 0 50 50' preserveAspectRatio='xMidYMid'><path d="M 25 2 25 22 M 18 10 A 19 19 0 1 0 32 10" stroke="white" stroke-width="4" fill="none"/></svg>
                        </div>
                        <div class="start-menu-settings-item start-menu-settings-settings">
                            <svg viewBox="0 0 1000 1000" preserveAspectRatio='xMidYMid'>
            <path d="M561.1,990H439c-20.9,0-38.2-15.8-40.4-36.1l-28-107.5c-8.2-2.9-16.3-6.2-24.3-9.7l-95.4,55.9c-15.5,12.5-39.9,11.4-54.2-3l-86.3-86.3c-14.8-14.8-15.7-38.2-3-54.2l53-90.1c-5-10.1-9.6-20.6-13.7-31.4L46.1,601.4C25.9,599.2,10,582,10,561.1V438.9c0-20.9,15.9-38.1,36.2-40.4l95.3-24.7c4.4-13.1,9.6-26,15.4-38.5l-49.5-84.5c-5.8-7.2-8.9-16.1-8.9-25.4c0-10.9,4.2-21.1,11.9-28.7l86.3-86.3c14.2-14.3,38.6-15.5,54.2-3l82.7,48.7c13.2-6.4,26.8-12,40.7-16.8l24.3-93.2C400.8,25.9,418.1,10,439,10h122.1c20.9,0,38.2,15.9,40.4,36.2l24.8,95.8c12.5,4.6,24.7,9.9,36.5,15.7l86.4-50.4c15.6-12.5,39.9-11.3,54.2,3l86.3,86.3c14.7,14.8,15.7,38.2,3,54.1l-53.5,91.3c4.2,9.6,8.1,19.4,11.5,29.4l103.2,27.1c20.3,2.3,36.1,19.5,36.1,40.4l0,122.1c-0.1,20.9-15.9,38.1-36.1,40.4l-108.4,28.3c-2.9,7.5-6.1,15-9.5,22.3l56.8,97.2c12.7,15.9,11.7,39.3-3,54l-86.4,86.4c-14.4,14.3-38.6,15.4-54.1,3l-98.5-57.7c-6.6,3-13.4,5.8-20.2,8.4l-29,110.6C599.2,974.2,581.9,990,561.1,990z M450.6,934.8h98.7l35.2-133.9l14.1-4.8c14-4.7,27.7-10.5,40.9-17.1l13.4-6.7l119.5,70.1l69.8-69.8l-69.3-118.6l7-13.5c7.1-13.7,13.3-28.1,18.3-42.8l4.8-14l131.5-34.3l0-98.7L807,417.1l-4.4-14.9c-5.1-17.1-11.6-33.7-19.3-49.4l-6.5-13.3l65.6-112l-69.8-69.8L664,221l-13.7-7.5c-17.5-9.6-36.2-17.7-55.5-24l-14.4-4.7l-31-119.6h-98.7l-30.7,117.7l-14.9,4.4c-20.6,6.2-40.6,14.4-59.4,24.5l-13.7,7.3l-104.5-61.5l-69.8,69.8l62.1,105.9l-7,13.5c-9.5,18.4-17.3,37.8-23,57.6l-4.4,15.1L65.2,450.7v98.7l123.9,32.3l4.8,14.1c6.1,17.9,13.5,35,22.2,50.9l7.5,13.7l-66,112.1l69.8,69.8l116-68l13.3,6.5c14.7,7.1,29.8,13.1,44.9,17.8l14.7,4.6L450.6,934.8z M496.5,705.3c-116.8,0-211.8-95-211.8-211.8c0-116.8,95-211.8,211.8-211.8c116.8,0,211.8,95,211.8,211.8C708.3,610.3,613.3,705.3,496.5,705.3z M496.5,336.9c-86.3,0-156.6,70.3-156.6,156.6c0,86.3,70.3,156.6,156.6,156.6c86.3,0,156.6-70.3,156.6-156.6C653.1,407.1,582.8,336.9,496.5,336.9z" fill="white" stroke="none"/>
</svg>
                        </div>
                    </div>
                    <div id="start-menu-apps"></div>
                </div>
            </div><!--Start Menu-->
            <div id="task-bar">
                <div class="task-bar-button" taskbarname="Start" onclick="openStart()">
                    <svg 
                    class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 257" preserveAspectRatio="xMidYMid"><path d="M0 36.357L104.62 22.11l.045 100.914-104.57.595L0 36.358zm104.57 98.293l.08 101.002L.081 221.275l-.006-87.302 104.494.677zm12.682-114.405L255.968 0v121.74l-138.716 1.1V20.246zM256 135.6l-.033 121.191-138.716-19.578-.194-101.84L256 135.6z" fill="#fff"/></svg>
                </div>
            </div><!--Task Bar-->
        
        </div>
    </body>
        
    
    
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js">
    </script>
    
    
    
    <script>
        
        /**
                Context-Menu by Omar5117
                
                https://www.khanacademy.org/computer-programming/o/6399597471023104
                
        **/
    
    
        var numMenus = 0, clPo = [], contextmenuEle
        function contextMenu(type, menu, ele, func){
            if(ele == document){return;}
            
            if(type.toUpperCase() == "CLICK"){event = "click"}
            else{event = "contextmenu"}
            if(ele == document){return;}
            $(ele).on(event, function(e) {
                $('.contMenu-wrapper').remove()
                numMenus = 0
                clPo = [e.clientX, e.clientY]
                contextmenuEle = $(this)
                if(func !== undefined){func(menu)}
                createContextMenu(menu, 'body', clPo)
                e.preventDefault()
            })
            
            $(document).mousedown(function(e){
                
                //If left click and mouse isnt inside .contMenu-wrapper
                if(e.which == 1 && $(e.target).closest(".contMenu-wrapper").length == false){
                    $('.contMenu-wrapper').remove()
                    numMenus = 0
                }
            })
        }
        function deleteContextMenu(ele, func){
            if(ele == document){return;}
            numMenus = 0
            if(func){func()}
            $(ele).off('contextmenu')
            $('.contMenu-wrapper').remove()
        }
        function createContextMenu(menu, ele, p){
            
            if(p == undefined){
                p = [clPo[0], clPo[1]]
            }
            
            numMenus ++
            
            $(ele).append('<div class="contMenu-wrapper" id="contMenu-' + numMenus + '"></div>')
            
            var n = '#contMenu-' + numMenus
            
            var numDisabled = 0
            
            
            for(var s = 0; s < menu.length; s ++){
                if(menu[s].hasOwnProperty('text')){
                    $(n).append('<div class="contMenu-item">' + menu[s].text + '</div>')
                }
                if(menu[s].hasOwnProperty('divider')){
                    $(n).append('<hr>')
                }
                if(menu[s].hasOwnProperty('action')){
                    const ind = menu[s]
                    $(n + ' .contMenu-item').eq(s).click(function(){
                        ind.action()
                        $('.contMenu-wrapper').remove()
                        numMenus = 0
                    })
                }
                if(menu[s].hasOwnProperty('style')){
                    $(n + ' .contMenu-item').eq(s).css(menu[s]["style"])
                }
                if(menu[s].hasOwnProperty('sub')){
                    $(n + ' .contMenu-item').eq(s).append('&nbsp;âžœ')
                }
                if(menu[s].hasOwnProperty('enabled')){
                    if(!menu[s].enabled){
                        $(n + ' .contMenu-item').eq(s).hide()
                        numDisabled ++
                    }
                }
            }
            
            
            var nwidth = $(n).width()
            var nheight = $(n).outerHeight()
            
            {
            
                d = []
                
                
                d[0] = p[0] + nwidth > $(window).width() ? 'left' : 'right'
                d[1] = p[1] + nheight > $(window).height() ? 'top' : 'down'
            
            {
            if(nheight >= $(window).height()){
                p[1] = 0
                var l = $(n).offset().left + p[0] - 10
                p[0] = l
                if(l + nwidth > $(window).width()){
                    p[0] = l-nwidth
                }
                
                $(n).addClass('limit-contextMenu')
                
            }//overflow
            else if(nheight >= $(window).height() / 2){
                
                $(n).css({
                    'position':'fixed',
                })
                
                var l = $(n).parent().offset().left + p[0]
                var t = $(n).parent().offset().top + p[1]
                
                
                if(l + nwidth > $(window).width()){
                    p[0] = l - p[0] - nwidth
                }
                else{
                    p[0] = l
                }
                
                if(t > $(window).height()/2){
                    p[1] = $(window).height() - nheight
                }
                else{
                    p[1] = 0
                }
                
                
            }//half overflow
            else{
                if(p == clPo){
                    if(d[1] == "top"){
                        p[1] = clPo[1] - nheight
                    }
                }
                else{
                    var t = $(n).offset().top + p[1] + 5
                    
                    if(t + nheight > $(window).height()){
                            
                            p[1] -= nheight - $('.contMenu-item').height() - 3
                            
                        }
                }
            }
            }//y
            
            {
            if(p == clPo){
                if(d[0] == "left"){
                    p[0] = $(window).width() - nwidth - 10
                }
            }
            else{
                var l = $(n).offset().left + p[0] + 5
                if(l + nwidth > $(window).width()){
                    p[0] = -nwidth
                }
            }
            }//x
            
            }//direction
            
            
            $(n).css({
                'left' : p[0],
                'top' : p[1],
            })
            
            
            
            
            
            $(n + ' .contMenu-item').each(function(q){
                $(this).mouseenter(function(){
                    if(menu[q].hasOwnProperty('sub')){
                        
                        // var verticalIndex = d[1] == "down" ? q*(nheight)-numDisabled*nheight : -menu[q].sub.length*nheight + (q+1)*nheight - numDisabled*nheight
                        
                        // var horizontalPos = d[0] == "left" ? -nwidth: nwidth
                        var h = $(this).position()
                        var verticalIndex = h.top
                        var horizontalPos = nwidth
                        
                        createContextMenu(menu[q].sub, $(this), [horizontalPos, verticalIndex])
                        
                    }
                })
                .mouseleave(function(){
                    numMenus -= $(this).children().length
                    $(this).children().remove()
                })
            })
                    
                
            
        }
        
    </script><!--Context Menu-->
    
    <script>
        /**
                Tooltip by Omar5117
                
                https://www.khanacademy.org/computer-programming/o/5004802808299520
                
        **/
        
        
        (function($){ 
            $.event.special.destroyed = { 
                remove: function(o) { 
                    if (o.handler) { 
                        o.handler()
                    }
                }
            }
        })(jQuery)
        

        $.fn.extend({ 
            tooltip: function(txt, delay, fade, css){ 
                
                var n = $('.tooltip').length
                var a = '.tooltip-' + n
                var d = delay || 600
                var f = fade || 200
                var p = []
                var des = css || { }
                
                $('body').append('<div class="tooltip tooltip-' + n +'">' + txt + '</div>')
                
                var dimen = [$(a).outerWidth(), $(a).outerHeight()]
                
                $(a)
                .css(des)
                .css('display', 'none')
                
                var h = $(this)
                var timeoutid = 0
                $(this).mouseenter(function(){ 
                    $(this).mousemove(function(e){ 
                        clearTimeout(timeoutid);
                        timoutid = 0
                        $(a).css('display', 'none')
                        
                        
                        timeoutid = setTimeout(function(){ 
                            
                            var p = [e.clientX, e.clientY]
                            var docDim = [$(document).width(), $(document).height()]
                            
                            
                            
                            if(p[0] < docDim[0]/2){ 
                                p[0] = e.clientX + 1
                            }
                            else{ 
                                p[0] = e.clientX - dimen[0] - 1
                            }
                            
                            if(p[1] > dimen[1] + 7){ 
                                p[1] = e.clientY - dimen[1] - 1
                            }
                            else{ 
                                p[1] = e.clientY + 20
                            }
                            
                            $(a).fadeIn(f).css({ 
                                'position': 'absolute',
                                'left': p[0],
                                'top': p[1],
                            })
                            
                        }, d);
                            
                    })
                })
                
                $(this).mouseleave(function(){ 
                    $(a).css('display', 'none')
                    clearTimeout(timeoutid);
                })
                
                $(this).on('destroyed', function(){ 
                    $(a).fadeOut('fast', function(){ 
                        $(this).remove()
                    })
                    clearTimeout(timeoutid);
                })
                
                return this
                
                
            }
        })
        
        
    </script><!--Tooltip-->
    
    <script>
            
            /**
                Drag and Resize by Omar5117
                
                
                deleted cuz noone is gonna use it unless for a very specific reason, also made it so u can only drag from top of element cuz im using it only for this program
                
                https://www.khanacademy.org/computer-programming/drag-and-resize/5469932011077632
            **/
            
            var dragresizableElements = []
            function dragresize(elmnt){ 
                
                if(dragresizableElements.indexOf(elmnt)!= -1){ 
                    return;
                }
                else{ 
                    dragresizableElements.push(elmnt)
                }
                
                var p1 = 0, p2 = 0, p3 = 0, p4 = 0, m = 0, d;
                var a1 = 0, a2 = 0, lef = false, rig = false, top = false, dow = false;
                
                
                var difference = 5;
                //5 pixel difference between drag and resize
                
                $(elmnt)
                .mousedown(function(e){ 
                    
                    m = 1
                    var temp = window.getComputedStyle(document.body).getPropertyValue('--appth')
                    temp = Number(temp.slice(0, temp.length - 2))
                    
                    
                    if(e.pageX >= $(this).offset().left + difference && e.pageX <= ($(this).offset().left + $(this).width()) - difference && e.pageY >= $(this).offset().top + difference && e.pageY <= ($(this).offset().top + temp)){ 
                    
                    //If dragging not resizing    
                    
                
    d=true
                    p3 = e.pageX
                    p4 = e.pageY
                    }
                    else{ 
                        //If resizing not dragging
                        d=false
                        a1 = $(this).offset().left + $(this).width()
                        
                        a2 = $(this).offset().top + $(this).height()
                        
                        
                        if($(this).offset().left - e.pageX <= 0 && $(this).offset().left - e.pageX > -difference){ 
                    
                    //If resizing LEFT
                            lef = true
                        }
                        else if(($(this).offset().left + $(this).width()) - e.pageX >= 0 && ($(this).offset().left + $(this).width()) - e.pageX < difference){ 
                    
                    //If resizing RIGHT
                            rig = true
                        }
                        
                        if(($(this).offset().top + $(this).height()) - e.pageY >= 0 && ($(this).offset().top + $(this).height()) - e.pageY < difference){ 
                    
                    //If resizing DOWN
                            dow = true
                        }
                        else if($(this).offset().top - e.pageY <= 0 && $(this).offset().top - e.pageY > -difference){ 
                    
                    //If resizing TOP
                            top = true
                        }
                    
                    }
                    
                    
                    
                })
                .mouseup(function(){ 
                    m=0
                    lef = false
                    rig = false
                    top = false
                    dow = false
                    
                })
                .mousemove(function(e){ 
                    if($(elmnt).attr('dragresizable') == "true"){ 
                        if((($(this).offset().left - e.pageX <= 0 && $(this).offset().left - e.pageX > -difference) && ($(this).offset().top - e.pageY <= 0 && $(this).offset().top - e.pageY > -difference)) || (($(this).offset().left + $(this).width()) - e.pageX >= 0 && (($(this).offset().left + $(this).width()) - e.pageX < difference) && ($(this).offset().top + $(this).height()) - e.pageY >= 0 && (($(this).offset().top + $(this).height()) - e.pageY < difference))){ 
                            $(this).css('cursor','nw-resize')
                        }
                        else if((($(this).offset().left - e.pageX <= 0 && $(this).offset().left - e.pageX > -difference) && ($(this).offset().top + $(this).height()) - e.pageY >= 0 && (($(this).offset().top + $(this).height()) - e.pageY < difference)) || ((($(this).offset().left + $(this).width()) - e.pageX < difference) && ($(this).offset().top - e.pageY <= 0 && $(this).offset().top - e.pageY > -difference))){ 
                            $(this).css('cursor','sw-resize')
                        }
                        else if(($(this).offset().left - e.pageX <= 0 && $(this).offset().left - e.pageX > -difference) || ($(this).offset().left + $(this).width()) - e.pageX >= 0 && (($(this).offset().left + $(this).width()) - e.pageX < difference)){ 
                            $(this).css('cursor','w-resize')
                        }
                        else if(($(this).offset().top - e.pageY <= 0 && $(this).offset().top - e.pageY > -difference) || ($(this).offset().top + $(this).height()) - e.pageY >= 0 && (($(this).offset().top + $(this).height()) - e.pageY < difference)){ 
                            $(this).css('cursor','n-resize')
                        }
                        else{ 
                            $(this).css('cursor','default')
                        }
                
                    }
                    else{ 
                            $(this).css('cursor','default')
                    }
                })
                .css({ 
                    'position' : 'absolute',
                    'user-select' : 'none',
                })
                
                
                $(document)
                .mouseup(function(){ 
                    m=0
                    lef = false
                    rig = false
                    top = false
                    dow = false
                    $('iframe').css('pointer-events', 'auto')
                })
                .mousemove(function(e){ 
                    
                    var pX = e.pageX;
                    var pY = e.pageY;
                    
                    if(pY < 0){pY = 0}
                    else if(pY > $(window).height()-30){pY = $(window).height()-30}
                    if(pX < 0){pX = 0}
                    else if(pX > $(window).width()){pX = $(window).width()}
                    
                    if($(elmnt).attr('dragresizable') == "true"){ 
                        $('iframe').css('pointer-events', 'none')
                        if(m & d){ 
                        
                        p1 = p3 - pX
                        p2 = p4 - pY
                        p3 = pX
                        p4 = pY
                        
                        $(elmnt).css({ 
                            
                            'top' : ($(elmnt).offset().top - p2) + 'px',
                            
                            'left' : ($(elmnt).offset().left - p1) + 'px'
                        })
                        
                    } //dragging
                        else if(m && !d){ 
                        
                        if(lef){ 
                            
                            
                            $(elmnt).css({ 
                                
                                'left' : pX + 'px',
                                'width' : (a1 - pX) + 'px',
                            })
                        }
                        else if(rig){ 
                            
                            $(elmnt).css({ 
                                
                                'width' : (pX - $(elmnt).offset().left) + 'px',
                        })
                        }
                        if(dow){ 
                            
                            $(elmnt).css({ 
                                'height' : pY - $(elmnt).offset().top + 'px',
                                
                            })
                        }
                        else if(top){ 
                            
                            $(elmnt).css({ 
                                'top' : pY + 'px',
                                'height' : (a2 - pY) + 'px',
                            })
                        }
                    } //resizing
                    }
                })
                

            }
            function updateDragresize(){ 
                for(var i = 0; i < $('[dragresizable]').length; i ++){ 
                dragresize($('[dragresizable]')[i])
            }
            }
            
        </script><!--Drag and Resize-->
    
    <script>
        
        
        /*$(window).ready(function(){ 
            document.write('<!DOCTYPE html> ' + document.documentElement.outerHTML.replaceAll('KAInfiniteLoopProtect();', ''))
        })*/
        
        $('.startupButtonFull').click(function(){ 
            
            $('.startup').hide()
            
            var w = window.open('')
            w.document.write('<!DOCTYPE html> ' + document.documentElement.outerHTML.replaceAll('KAInfiniteLoopProtect();', ''))
            var a = document.createElement('script')
            a.innerHTML = "openFile('C:/Windows/Source/Javascript_At_Startup.exe')"
            w.document.body.appendChild(a)
            
            $('.startup').show()
            
        })
        $('.startupButtonNorm').click(function(){ 
            $('.startup').hide()
            openFile('C:/Windows/Source/Javascript_At_Startup.exe')
        })
        
        $(document)
        .contextmenu(function(e){ 
            e.preventDefault()
        })
        
        
        String.prototype.replaceAt = function(index, replacement) { 
    if (index >= this.length) { 
        return this.valueOf();
    }
 
    return this.substring(0, index) + replacement + this.substring(index + 1);
        }
        
        Object.size = function(obj) { 
            var size = 0,
            key;
            for (key in obj) { 
                if (obj.hasOwnProperty(key)) size++;
            }
            return size;
        };
        
        function deepClone(obj, format) { 
                
            /**
                
                NAFS TREEVIEW (bel fileexplorer), BAS KAMAN BENSA5 (dates, arrays, objects, w functions)
                
                 enseet min wen nasa5to, bas 9'defet 3ale lal functions
                 
            **/
                
            var refs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Map();
            
            var cloned = refs.get(obj);
            if (cloned) return cloned;
            if (Array.isArray(obj)) { 
                var _clone = [];
                refs.set(obj, _clone);
                for (var i = 0; i < obj.length; i++) { 
                  _clone[i] = deepClone(obj[i], format, refs);
                }
                return _clone;
              }
            if (obj instanceof Date) return new Date(obj.valueOf());
            if (!(obj instanceof Object)) return obj;
            if(typeof obj == "function") return obj;
            
            var clone = { };
            refs.set(obj, clone);
            var keys = Object.keys(obj);
            for (var _i = 0; _i < keys.length; _i++) { 
                var key = format ? format(keys[_i]) : keys[_i];
                clone[key] = deepClone(obj[keys[_i]], format, refs);
              }
            return clone;
        }
    
        function EXEinFiles(){ 
            var results = []
            function g(item, p){ 
                item = item || FILESYSTEM
                var path = p || ''
                Object.keys(item).forEach(function(key){ 
                    //kol el folders ella source w base
                    if(filePath.type(key) === "File folder" && p+'/'+key !== "C:/Windows/Source" && p+'/'+key !== "C:/Windows/Base"){ 
                        if(p !== undefined){ 
                        path += '/' + key
                        }
                        else{ 
                            path += key
                        }
                        g(item[key], path)
                    }
                    else if(key.split('.')[key.split('.').length-1] == "exe"){ 
                        results.push(path + '/' + key)
                    }
                    
                    if(p == undefined){ p = key}
                    
                    path = p
                })
            }
            g(FILESYSTEM)
            
            //results bekoon array b3abba paths
            return results;
        }

        function consoleMessage(txt, type){ 
            if(type == "error"){ 
                a = 'background:rgba(255, 0, 0, 0.6); color: #fff; font-weight:1000; border:1px solid rgb(237, 99, 99); padding:5px;'
            }
            else if(type == "warning"){ 
                a = 'background:rgba(115, 93, 50); color: #fff; font-weight:1000; border:1px solid orange; padding:5px;'
            }
            else if(type == "system"){ 
                a = 'background:rgba(0, 0, 0); color: #fff; font-weight:0; border:1px dashed white; padding:5px; font-family:monospace;'
            }
            else{ 
                a = 'background:rgb(46, 15, 107); color: #fff; font-weight:1000; padding:5px;'
            }
            console.log('%c' + txt, a)
        }
        
        function dateString(arr){ 
            if(arr !== undefined){ 
                return arr[0] + '/' + arr[1] + '/' + arr[2]
            }
            
            return ""
        }
        
        function getDateArray(){ 
            var d = new Date()
            return [d.getDate(), d.getMonth()+1, d.getFullYear()]
        }
        
        function lightOrDark(color) { 
    
/**
    https://codepen.io/andreaswik/pen/YjJqpK
**/

  // Check the format of the color, HEX or RGB?
  if (color.match(/^rgb/)) { 

    // If HEX --> store the red, green, blue values in separate variables
    color = color.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);

    r = color[1];
    g = color[2];
    b = color[3];
  } 
  else { 

    // If RGB --> Convert it to HEX: http://gist.github.com/983661
    color = +("0x" + color.slice(1).replace( 
      color.length < 5 && /./g, '$&$&'
    )
             );

    r = color >> 16;
    g = color >> 8 & 255;
    b = color & 255;
  }

  // HSP (Highly Sensitive Poo) equation from http://alienryderflex.com/hsp.html
  hsp = Math.sqrt(
    0.299 * (r * r) +
    0.587 * (g * g) +
    0.114 * (b * b)
  );

  // Using the HSP value, determine whether the color is light or dark
  // Original = 127.5
  
  if (hsp>200) { 

    return 'light';
    
  } 
  else { 

    return 'dark';
  }
}
        
        function hexToRgb(hex) { 
            var result = /^#?([a-f\d]{ 2})([a-f\d]{ 2})([a-f\d]{ 2})$/i.exec(hex);
            return result ? { 
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }
        
        function whiteOrBlack(color){ 
            if(color.match(/^rgb/)){ 
                color = color.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);
                
                r = Number(color[1])
                g = Number(color[2])
                b = Number(color[3])
                
                
            } //if rgb
            else if(color[0] == "#"){ 
                color = hexToRgb(color)
                
                r = color.r
                g = color.g
                b = color.b
            } //if Hex
            else{ 
                return 0
            } //if "red" or "white" etc (always returns 0)
            
            return (r+g+b)/3
            
        }
        
        
    </script><!--Extra Functions-->
    
    <script>
        
        
        function openStart(){ 
            
            $('#start-menu').slideToggle().animate({ 'height': '80%'})
            
            $('#start-menu-apps')
            .empty()
            
            //exe files
            EXEinFiles().forEach(function(w){ 
                $('#start-menu-apps').append('<div class="start-menu-apps-app" dir="' + w + '"><div class="start-menu-apps-icon">' + fileIcon(w) + '</div><div class="start-menu-apps-name">' + filePath.name(w) + '</div></div>')
                
                $('.start-menu-apps-app').last().dblclick(function(){ 
                    openFile($(this).attr('dir'))
                })
            })
            
            //exe files folder
            EXEinFiles().forEach(function(w){ 
                w = filePath.folder(w)
                $('#start-menu-apps').append('<div class="start-menu-apps-app" dir="' + w + '"><div class="start-menu-apps-icon">' + fileIcon(w) + '</div><div class="start-menu-apps-name">' + filePath.name(w) + '</div></div>')
                
                $('.start-menu-apps-app').last().dblclick(function(){ 
                    openFile($(this).attr('dir'))
                })
            })
            
        }
        
        
        { 
            
            function addTaskbar(lnk, pin){ 
                
                var name = filePath.formattedName(lnk)
                
                var a = fileIcon(lnk)
                
                
                if(!$('[taskbarname = '+ name +']').length){ 
                    $('#task-bar').append('<div class="task-bar-button" taskbarname="' + name + '" dir="' + lnk + '"><div class="task-bar-button-svg">' + a + '</div></div>')
                    $('[taskbarname = '+ name +']').tooltip(name)
                    
                    //Add taskbar preview and click event
                    var toggle = 0
                    $('#task-bar [taskbarname = '+ name +']')
                    .append('<div class="task-bar-view task-bar-view-' + name + '"></div>')
                    .click(function(){ 
                        
                        //Etha kont fate7 bas application wa7ad, hide o shoe
                        //Etha thnen preview
                        
                        if($('.application-' + name).length < 2){ 
                            
                            if($('.application-' + name).css('display') == "none"){ 
                                $('.application-' + name).show()
                                if($('.application-current')[0] !== undefined){ 
                                    $('.application-current').removeClass('application-current')
                                }
                                    $('.application-' + name).addClass('application-current')
                                }
                            else{ 
                                $('.application-' + name).hide()
                            }
                            
                        }
                        else{ 
                            var s = $(this).children('.task-bar-view')
                            
                            //mo7tawayato
                            s.empty()
                            for(var f = 0; f < $('.application-' + name).length; f ++){ 
                                s.append('<div class="task-bar-view-app" ind=' + f + ' name=' + name + '><div class="task-bar-view-top"><div class="task-bar-view-name">' + name + '</div><div class="task-bar-view-close">\
                                <svg viewBox="0 0 10 10" style="display:block; transform:scale(0.36) translateY(-5px); stroke:white"><path d="M 0 0 10 10 M 10 0 0 10" stroke-width="1.5" fill="none"></svg>\
                                </div></div><div class="task-bar-view-bottom"><div class="task-bar-view-bottom-app"></div></div></div>')
                                
                                
                            }
                            
                            $('.task-bar-view-app', s).each(function(e){ 
                                //VERY messy, btesta3mel el task-bar-view-name w el \\ind// attribute 3ashan enlagi el app ta3to, ba3den 3al hover menzabetlo el app-current
                                $(this).hover(function(){ 
                                    var n = $(this).attr('name')
                                    var i = Number($(this).attr('ind'))
                                        
                                    var app = $($('.application-' + n)[i])
                                    { 
                                    app.show()
                                    if($('.application-current')[0] !== undefined){ 
                                    $('.application-current').removeClass('application-current')
                                }
                                    app.addClass('application-current')
                                    }//bring to front
                                })
                                $('.task-bar-view-close', this).click(function(){ 
                                    var p = $(this).parents('.task-bar-view-app')
                                    var n = p.attr('name')
                                    var i = Number(p.attr('ind'))
                                    var app = $($('.application-' + n)[i])
                                    closeApplication(app, n)
                                    
                                    toggle = 1
                                
                                    s.animate({ 
                                        opacity: 0,
                                        top: 0,
                                    }, 200, function(){ 
                                            $(this).hide()
                                        })
                                    })
                                })
                            
                            //overflow \/
                            if($('.application-' + name).length * 100 > $(window).width()){ 
                                s.css('left', 0)
                            }
                            
                            //toggle slide o opacity (animations lal design)
                            
                            { 
                            if(toggle){ 
                                toggle = 0
                                
                                s.animate({ 
                                    opacity: 0,
                                    top: 0,
                                }, 200, function(){ 
                                        $(this).hide()
                                    })
                            }
                            else{ 
                                toggle = 1
                                s.show().animate({ 
                                    opacity: 1,
                                    top: '-' + $('body').css('--barh'),
                                }, 200)
                            }
                            }
                            
                            
                            
                        }
                        
                        
                    })
                    
                    
                    var menu = [
                        { 
                            "text": "Bring to center",
                            "action": function(){ 
                                var n = contextmenuEle.attr('taskbarname')
                                $('.application-' + n).each(function(){ 
                                    $(this).css({ 
                                        'left': $(window).width()/2 - $(this).width()/2,
                                        'top' : $(window).height()/2 - $(this).height()/2
                                    })
                                })
                            },
                        }, //Bring to center
                        { 
                            "text": "Close all",
                            "action": function(){ 
                                var n = contextmenuEle.attr('taskbarname')
                                $('.application-' + n).each(function(){ 
                                    closeApplication($(this), n)
                                })
                            }
                        }, //Close
                        { 
                            "text": "Launch",
                            "action": function(){ 
                                var dir = contextmenuEle.attr('dir')
                                openFile(dir)
                            }
                        },
                        { 
                            "text": "Unpin from taskbar",
                            "action": function(){ 
                                var dir = contextmenuEle.attr('dir')
                                unpinTaskbar(dir)
                            }
                        }, //Unpin from taskbar
                        { 
                            "text": "Pin to taskbar",
                            "action": function(){ 
                                var dir = contextmenuEle.attr('dir')
                                pinTaskbar(dir)
                            }
                        }, //Pin to taskbar
                    ]
                    
                    function handleMenu(m){ 
                        var n = contextmenuEle.attr('taskbarname')
                        if($('.application-' + n).length == 0){ 
                            m[0].enabled = false
                            m[1].enabled = false
                        }
                        else{ 
                            m[0].enabled = true
                            m[1].enabled = true
                        }
                        
                        
                        if(contextmenuEle.attr('pinned') == ""){ 
                            m[3].enabled = true
                            m[4].enabled = false
                        }
                        else{ 
                            
                            m[4].enabled = true
                            m[3].enabled = false
                        }
                        
                    }
                    
                    
                    contextMenu('contextMenu', menu, '#task-bar [taskbarname = '+ name +']', handleMenu)
                }
                
                if(pin){ 
                    $('[taskbarname = '+ name +']').attr('pinned', "")
                }
                
                
            }
            
            function removeTaskbar(n){ 
               
                var name = filePath.formattedName(n)
                
                if($('.application-' + name).length == 0 && $('[taskbarname = '+ name +']').attr('pinned') == undefined){ 
                    $('[taskbarname = '+ name +']').remove()
                }
                else if($('.application-' + name).length == 0 && $('[taskbarname = '+ name +']').attr('pinned') == ""){ 
                    $('[taskbarname = '+ name +']').css('background-color', '')
                }
                
            }
            
            function pinTaskbar(lnk){ 
                
                //"C:/Program_Files/Photos/Photos.exe"
                var n = filePath.formattedName(lnk)
                
                var a = lnk.split('/')
                a[a.length-1] = "icon.svg"
                a = a.join('/')
                
                //Pinned attribute
                if($('[taskbarname = '+ n +']').length > 0){ 
                    $('[taskbarname = '+ n +']').attr('pinned', "")
                }
                else{ 
                    addTaskbar(lnk, true)
                }
                
                
                if(filePath.data('C:/Users/Me/Pinned/Taskbar')[n + ".lnk"] !== undefined){ 
                    filePath.data('C:/Users/Me/Pinned/Taskbar')[n + ".lnk"][0] = lnk
                } 
                else{ 
                    createFile('C:/Users/Me/Pinned/Taskbar', n + '.lnk', lnk)
                }
                
                //openFile()
                $('[taskbarname = '+ n +']').click(function(){ 
                    
                    if($('.application-' + n).length == 0){ 
                        openFile(lnk)
                    }
                    
                })
                
                
            }
            
            function unpinTaskbar(lnk){ 
                var d = filePath.formattedName(lnk)
                $('.task-bar-button[pinned][taskbarname="' + d + '"]').removeAttr('pinned')
                
                deleteFile('C:/Users/Me/Pinned/Taskbar/' + d + '.lnk')
                removeTaskbar(d)
                
                
            }
            
            function startupTaskbar(){ 
                
                $('[pinned]').each(function(){ 
                    $(this).removeAttr('pinned')
                    var s = $(this).attr('taskbarname')
                    removeTaskbar(s)
                })
                
                
                var p = filePath.data("C:/Users/Me/Pinned/Taskbar")
                
                for(var a in p){ 
                    
                    if(filePath.type(a) !== "lnk"){ 
                        openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', 'Only LNK files allowed in <b>C:/Users/Me/Pinned/Taskbar</b>\n<b>' + a + '</b> will be ignored', 'error', null, null])
                        continue;
                    }
                    
                    pinTaskbar(p[a][0])
                    
                }
                
                $('[taskbarname = Start]').tooltip('Start')
                
            }

            
            
        }// TASK BAR
        
        
        { 
            
            function addDesktop(lnk){ 
                
                var name = filePath.name(lnk)
                var icon = fileIcon(lnk)
                var fullname = lnk.split('/')[lnk.split('/').length-1]
                $('#desktop').append('<div class="desktop-app" dir="' + lnk + '"><div class="desktop-icon">' + icon + '</div><div class="desktop-name">' + name + '</div></div>')
                
                var app = $('#desktop > .desktop-app').last()
                if(filePath.type(lnk) == "lnk"){ 
                    app.tooltip('Name: ' + name + '<br>Location: ' + lnk)
                }
                else{ 
                    //fType -> File folder? ethan mish uppercase
                    var fType = filePath.type(lnk) == "File folder" ? filePath.type(lnk) : filePath.type(lnk).toUpperCase() + ' file'
                    
                    app.tooltip('File type: ' + fType + '<br>File name: ' + fullname + '<br>Data-type: ' + typeof filePath.data(lnk))
                }
                
                var shiftOrCtrl = false
                app
                .click(function(e){ 
                    if(e.shiftKey || e.ctrlKey){ 
                        shiftOrCtrl = true
                    }
                    else{ shiftOrCtrl = false}
                    
                    
                    if(!shiftOrCtrl){ 
                        $('.desktop-app-selected').removeClass('desktop-app-selected')
                    }
                    $(this).addClass('desktop-app-selected')
                })
                .dblclick(function(){ 
                    
                    $('.desktop-app-selected').each(function(){ 
                        openFile($(this).attr('dir'))
                    })
                    
                })
                
                
                
            }
            function startupDesktop(){ 
                var dat = filePath.data('C:/Users/Me/Desktop')
                
                for(var a in dat){ 
                    
                    addDesktop('C:/Users/Me/Desktop/' + a)
                    
                }
                
                var shiftOrCtrl = false
                
                $(document)
                .click(function(e){ 
                    if(e.shiftKey || e.ctrlKey){ 
                        shiftOrCtrl = true
                    }
                    else{ shiftOrCtrl = false}
                    
                    if($(e.target).closest('.desktop-app').length == false && !shiftOrCtrl){ 
                        $('.desktop-app-selected').removeClass('desktop-app-selected')
                    }
                })
            
                
                var desktopMenu = [
                    { 
                        "text": "Refresh",
                        "action": refreshDesktop
                    },// Refresh
                    { 
                        "text": "Paste file",
                        "action": function(){ 
                            pasteFile('C:/Users/Me/Desktop')
                            refreshDesktop()
                        }
                    },// Paste file
                    { 
                        "text": "Open desktop in File Explorer",
                        "action": function(){ 
                            openFile('C:/Users/Me/Desktop')
                        },
                        "divider": true,
                    },// Open Des....lorer --- (divider)
                    { 
                        "text": "New folder",
                        "action": function(){ 
                            createFile('C:/Users/Me/Desktop', "New Folder")
                            refreshDesktop()
                        },
                        "divider": true,
                    },// New folder -- (divider)
                    { 
                        "text": "Personalize",
                        "action": function(){ 
                            
                        }
                    },// Personalize
                ]
                var desktopAppMenu = [
                    { 
                        "text": "Open",
                        "action": function(){ 
                            openFile(contextmenuEle.attr('dir'))
                        }
                    }
                ]
                
                contextMenu('contextmenu', desktopMenu, '#desktop:not(.desktop-app)')
                
                refreshWallpaper()
            }
            function refreshDesktop(){ 
                $('#desktop').empty()
                var dat = filePath.data("C:/Users/Me/Desktop")
                for(var a in dat){ 
                    addDesktop('C:/Users/Me/Desktop/' + a)
                }
                
                refreshWallpaper()
                
                saveOS()
            }
            
        }// DESKTOP
        
        
        { 
            
            
            
            var fileClipboard = [];
            function copyFile(arr, func){ 
                //["C:/Users", "C:/Windows/...", "A:/..."]
                fileClipboard = []
                for(var d = 0; d < arr.length; d ++){ 
                    var lnk = arr[d]
                    if(filePath.alldata(lnk) !== undefined){ 
                        var name = lnk.split('/')[lnk.split('/').length-1]
                        var data = deepClone(filePath.alldata(lnk))
                        
                        var pastFolder = filePath.folder(lnk)
                        
                        
                        fileClipboard[d] = [name, data, pastFolder]
                        
                        consoleMessage('Copied file\n' + lnk)
                        
                        if(func){ func(lnk)}
                    }
                }
                
                
            }
            
            function pasteFile(fol){ 
                
                for(var d = 0; d < fileClipboard.length; d ++){ 
                    createFile(fol, fileClipboard[d][0], fileClipboard[d][1], true)
                    consoleMessage('Pasted files in\n' + fol)
                }
                
            }
            
            
        }// CLIPBOARD FOR FILES
        
        
        {
            
            function refreshWallpaper(){
                var wp = filePath.data('C:/Windows/Base/Settings/wallpaper.png')
                if(wp !== undefined){
                    $('body').css('background-image', 'url(' + wp + ')')
                    
                }
            }
            
        }// WINDOWS
        
    </script><!--WINDOWS OS-->
    
    <script>
        
        var openedScreens = 0;
        
        function closeApplication(app, name){ 
            $(app).remove()
            removeTaskbar(name)
        }
        function applicationHolder(css, lnk, o){ 
            
            if(Object.keys(css).length == 0){ 
                consoleMessage('No CSS entered', "warning")
            }
            if(lnk==null){ 
                consoleMessage('No dir entered', "error")
                return
            }
            if(o==null){ 
                o = { 
                    minimize:true,
                    maximize:true,
                    close:true,
                }
            }
            
            var n = "#application-" + openedScreens
            var icon = filePath.data('./icon.svg')
            var name = filePath.name(lnk)
            var formatName = filePath.formattedName(lnk)
            var col = "white"
            
            { 
                
                if(css['left']==undefined){ 
                    css['left'] = Math.random()*400 + 'px'
                }
                if(css['top']==undefined){ 
                    css['top'] = Math.random()*150 + 'px'
                }
                
            }// application position
            
            { 
                
                if(css["background-color"] !== undefined){ 
                    if(whiteOrBlack(css["background-color"]) >= 200){ 
                        col = "black"
                    }
                }
                
            }//Color of name and buttons
            
            { 
            $('body').append('<div class="application-holder application-' + formatName + '" id="application-' + openedScreens + '"  dragresizable=true></div>')
            $(n)
            .append('<div class="application-holder-top"><span class="application-holder-top-name" style="color:' + col + '">' + name + '</span><div class="application-holder-top-button-holder"></div></div>').css(css)
      
            .append('<div class="app"></div>').css(css)
            
            
        }//Design
        
            { 
                //Bring to front
                if($('.application-current')[0] !== undefined){ 
                    $('.application-current').first().removeClass('application-current')
                    }
                $(this).addClass('application-current')
                
                //Bring to front WHEN mouse down
                $(n).mousedown(function(){ 
                    
                    if($('.application-current')[0] !== undefined){ 
                    $('.application-current').first().removeClass('application-current')
                    }
                    
                    $(this).addClass('application-current')
                    
                })
            }//.application-current
            
            { 
                
                addTaskbar(lnk)
                
                $('[taskbarname = '+ filePath.formattedName(lnk) +']').css('background-color','rgba(158, 202, 255,0.35)')
                
            }//task bar
            
            { 
                
            if(o.minimize){ 
                
                { 
                $(n + ' .application-holder-top-button-holder').append('<div class="application-holder-top-button button-style minimize-button"></div>')
                }//Make button
                { 
                    $(n + ' .minimize-button').append('<svg viewBox="0 0 10 10" style="display:block; transform:scale(0.36) translateY(-5px); stroke:' + col + '"><path d="M 0 5 10 5" fill="none" stroke-width="1.5"></svg>')
                }//Design of button
                
                $(n + ' .minimize-button').click(function(){ 
                    $(n).css('display', 'none')
                })
                
            }
                
            }//minimize-button (and task bar clicked))
            
            { 
                
            if(o.maximize){ 
                
                { 
                $(n + ' .application-holder-top-button-holder').append('<div class="application-holder-top-button button-style maximize-button"></div>')
                }//Make button
                { 
                    $(n + ' .maximize-button').append('<svg viewBox="0 0 10 10" style="display:block; transform:scale(0.36) translateY(-5px); stroke:' + col + '"><path d="M 0 1 10 1 10 8 0 8 0 1" stroke-width="1.5" fill="none"></svg>')
                }//Design of button
                
                
                var ttt = 1, pos=[]
                
                $(n + ' .maximize-button').click(function(){ 
                    ttt = ttt ? 0 : 1
                    
                    if(!ttt){ 
                        
                        
                        pos = [$(n).offset().left, $(n).offset().top, $(n).width(), $(n).height()]
                        
                        $(n).css({ 
                        'left':0,
                        'top':0,
                        'width': '100%',
                        'height':'calc(100% - var(--barh)'
                    })
                        .attr('dragresizable', false)
                    }
                    else{ 
                        
                        $(n).css({ 
                            'left': pos[0],
                            'top': pos[1],
                            'width': pos[2],
                            'height': pos[3],
                                
                        })
                        .attr('dragresizable', true)
                    }
                })
            }
            
            }//maximize-button
            
            { 
                
            if(o.close){ 
                
                { 
                $(n + ' .application-holder-top-button-holder').append('<div class="application-holder-top-button button-style close-button"></div>')
                }//Make button
                { 
                    $(n + ' .close-button').append('<svg viewBox="0 0 10 10" style="display:block; transform:scale(0.36) translateY(-5px); stroke:' + col + '"><path d="M 0 0 10 10 M 10 0 0 10" stroke-width="1.5" fill="none"></svg>')
                }//Design of button
                
                
                $(n + ' .close-button').click(function(){ 
                    closeApplication(n, lnk)
                })
            }
            
            }//close-button
            
            consoleMessage('Opening application holder for  ->  ' + lnk + '\n- OpenedScreens = ' + openedScreens)
            
            openedScreens++
            
            
            updateDragresize()
            
        }
         
        
    </script><!--Application Structure-->
    
    <script>
        
        /**
            Katebhom kol no3 elo object la7al 3ashan yekoon mratab, bas bek hageega mish hek bitsha3'el, kol ma ta3mal file ijdeed, FILEDATA bezeed, honak be7at el data w el file bel FILESYSTEM be9eer elo ka id --> FILEDATA[2] --> id 2 feeyo el data ta3o
        **/
        
        function processingJS(codeNum){ 
            var codes = [
               
                'size(400, 400);    \n    frameRate(30);    \n        \n    // Paste code from Khan Academy here:    \n    fill(255, 255, 0);    \n    ellipse(200, 200, 200, 200);    \n    noFill();    \n    stroke(0, 0, 0);    \n    strokeWeight(2);    \n    arc(200, 200, 150, 100, 0, PI);    \n    fill(0, 0, 0);    \n    ellipse(250, 200, 10, 10);    \n    ellipse(153, 200, 10, 10);' //Test
        
        
            
            ]
            
            return eval(codes[codeNum])
        }
        
        
        var svgFile = { 
                
                
            //----------PHOTOS-----------//
                
                
                photos_trash_image:[
                    '<svg xmlns="http://www.w3.org/2000/svg" viewBox="-2 -5 36 36"><path d="M15 4c-.522 0-1.06.185-1.438.563C13.185 4.94 13 5.478 13 6v1H7v2h1v16c0 1.645 1.355 3 3 3h12c1.645 0 3-1.355 3-3V9h1V7h-6V6c0-.522-.185-1.06-.563-1.438C20.06 4.186 19.523 4 19 4h-4zm0 2h4v1h-4V6zm-5 3h14v16c0 .555-.445 1-1 1H11c-.555 0-1-.445-1-1V9zm2 3v11h2V12h-2zm4 0v11h2V12h-2zm4 0v11h2V12h-2z" stroke="" fill="white"/></svg>'],
                
                photos_icon:[
                    '<svg class="icon" viewBox="0 0 20 20" style="border-radius:10%; " preserveAspectRatio="xMidYMid"> <rect width="20" height="20" fill="url(#photoIconGrad)"></rect> <circle cx="13.5" cy="5" r="2" fill="rgb(242, 242, 242)"></circle> <path d="M 3 20 12 10 A 10 55 0 0 1 15 10 L 25 21 2 20" fill="rgb(67, 109, 204)" stroke="" stroke-linejoin="round"/> <path d="M 0 13 5 8 A 10 55 0 0 1 8 8 L 20 20 0 20" fill="rgb(18, 73, 137)" stroke="" stroke-linejoin="round"/> </svg>'],
                
                
            //---------------------------//
                
                
                
                
            //----------POPUP-----------//
                
                
                popup_error_image:[
                    '<svg class="popup-content-image-svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">  <circle cx="50" cy="50" r="40" fill="rgb(255, 60, 60)" />  <circle cx="50" cy="50" r="45" fill="none" stroke="rgb(255, 60, 60)" stroke-width="5" />  <path d="M 34 29 50 44 65 29 71 35 56 50 71 66 66 72 50 56 35 72 29 66 44 50 28 36 z" stroke="none" fill="white"/> </svg>'],
                    
                popup_warning_image:[
                    '<svg class="popup-content-image-svg" viewBox="0 0 60 50" preserveAspectRatio="xMidYMid"><path d="M 28 3 A 3 3 0 0 1 32 3 L 58 43 A 3 3 0 0 1 56 47 L 4 47 A 3 3 0 0 1 2 43 z" stroke="rgb(28, 28, 28)" stroke-width="2" fill="rgb(255, 208, 20)"/><path d="M 31 14 Q 33 25 31 31, 30 34 29 31, 27 24 29 14, 30 13 31 14 z" stroke="none" fill="rgb(28, 28, 28)"/><circle cx="30" cy="37" r="2" fill="rgb(28, 28, 28)"/></svg>'
                ],
                
                
            //---------------------------//
                
                
                
                
            //-------FILE EXPLORER-------//
                
                
                files_icon:[
                    '<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid" x="0px" y="0px" class="icon" viewBox="0 0 222 222"> <g id="_____2"> <g id="_____1" transform="matrix( 1, 0, 0, 1, 111.15,111.3) "> <g> <g> <g> <path fill="#E0C974" stroke="none" d=" M -32.45 72.25 L -17 72.25 -32.35 32.4 -32.45 72.25 Z"/> <path fill="#FECF3D" stroke="none" d=" M -89.45 -81.7 Q -95.5 -79.2 -96.55 -72.85 L -96.55 -49.45 -19.8 -49.45 -2.65 -65.35 Q -11.8 -77.4 -21.65 -81.7 L -89.45 -81.7 M -85.25 -61.05 L -85.25 -69.45 -76 -69.45 -76 -61.05 -85.25 -61.05 Z"/> <path fill="#0CCBE9" stroke="none" d=" M -85.25 -69.45 L -85.25 -61.05 -76 -61.05 -76 -69.45 -85.25 -69.45 Z"/> <path fill="#DAB946" stroke="none" d=" M 65.45 72.25 L 79.8 72.25 65.6 35.2 65.45 72.25 Z"/> <path fill="url(#Gradient_1)" stroke="none" d=" M 96.6 -58.25 Q 95 -64.55 89.1 -65.35 L -2.65 -65.35 -19.5 -48.65 -96.55 -48.65 -96.55 65.2 Q -94.3 71.75 -88.4 72.25 L -65 72.25 -65 69.75 -65 72.25 -32.45 72.25 -32.35 32.4 -17 72.25 65.45 72.25 65.6 35.2 79.8 72.25 89.45 72.25 Q 95.35 70.9 96.6 64.6 L 96.6 -58.25 Z"/> </g> </g> <g> <path stroke="url(#Gradient_2)" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d=" M 79.8 72.25 L 89.45 72.25 Q 95.35 70.9 96.6 64.6 L 96.6 -58.25 Q 95 -64.55 89.1 -65.35 L -2.65 -65.35 -19.5 -48.65 -96.55 -48.65 -96.55 65.2 Q -94.3 71.75 -88.4 72.25 L -65 72.25 M -17 72.25 L 65.45 72.25"/> </g> <g> <path stroke="#FECF3D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d=" M -2.65 -65.35 Q -11.8 -77.4 -21.65 -81.7 L -89.45 -81.7 Q -95.5 -79.2 -96.55 -72.85 L -96.55 -49.45 -19.8 -49.45 -2.65 -65.35 Z"/> </g> <g> <path stroke="#E0C974" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d=" M -65 72.25 L -65 69.75 M -17 72.25 L -32.45 72.25 -65 72.25 M -32.45 72.25 L -32.35 32.4 -17 72.25"/> </g> <g> <path stroke="#DAB946" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d=" M 79.8 72.25 L 65.45 72.25 65.6 35.2 79.8 72.25 Z"/> </g> </g> <g id="_____1" transform="matrix( 1, 0, 0, 1, 0.2,40.55) "> <g> <g> <g> <path fill="#3CCEF4" stroke="none" d=" M 32.75 -8.85 L 31.45 -8.85 31.45 -6.55 31.45 35.6 31.4 35.55 31.25 35.6 Q 31.05 35.6 31.05 35.75 L 30.95 35.85 30.9 36.05 30.95 36.2 30.95 36.3 31 36.35 30.95 36.4 31 36.55 30.95 36.55 30.95 40.8 31 40.85 31 40.95 Q 31.05 40.95 31.05 41 L 31.2 41.15 31.25 41.15 Q 31.3 41.2 31.35 41.2 31.4 41.2 31.45 41.2 31.5 41.2 31.55 41.2 L 31.6 41.2 31.65 41.15 Q 31.7 41.15 31.75 41.1 L 31.8 41.1 31.8 41.05 31.85 41 31.85 40.95 31.9 40.95 31.9 40.85 31.95 40.8 31.95 40.65 65.25 40.65 65.25 -26.5 Q 61.65 -37.55 51.5 -40.65 51.25 -40.7 51 -40.8 L 50.2 -41 Q 49.9 -41.1 49.55 -41.15 L -49.5 -41.15 Q -49.85 -41.1 -50.15 -41 -61.35 -38.3 -65.2 -27.55 L -65.2 40.65 -32.7 40.65 -32.7 -8.85 31.4 -8.85 31.45 -8.85 32.75 -8.85 Z"/> </g> </g> <g> <path stroke="#3CCEF4" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d=" M 32.75 -8.85 L 31.45 -8.85 31.45 -6.55 31.45 35.6 M 31.95 40.65 L 65.25 40.65 65.25 -26.5 Q 61.65 -37.55 51.5 -40.65 51.25 -40.7 51 -40.8 L 50.2 -41 Q 49.9 -41.1 49.55 -41.15 L -49.5 -41.15 Q -49.85 -41.1 -50.15 -41 -61.35 -38.3 -65.2 -27.55 L -65.2 40.65 -32.7 40.65 -32.7 -8.85 31.4 -8.85 31.45 -8.85 M 31.45 -6.55 L 31.4 -8.85 M 51 -40.8 Q 61.55 -37.9 65.25 -27.55 L 65.25 -26.5"/> </g> </g> </g> <g id="_____1" transform="matrix( 1, 0, 0, 1, -60.3,-65.25) "> <g> <g> <g> <path fill="#FFFFFF" stroke="none" d=" M 16.1 -4.2 L -16.1 -4.2 -16.1 4.2 16.1 4.2 16.1 -4.2 Z"/> </g> </g> </g> </g> </g> </g> </svg>'], //File Explorer (from wikimedia)
                
                files_empty_icon:[
                    '<svg class="icon" viewBox="0 0 20 20" preserveAspectRatio="xMidYMid"> <path d="M 3 1 3 19 17 19 17 6 11 1 3 1 z" stroke="rgb(190, 190, 190)" fill="rgb(230, 230, 230)" /> <path d="M 10 1 10 7 17 7" stroke="rgb(190, 190, 190)" fill="none" /> </svg>'],
                
                files_folder_icon:[
                    '<svg class="icon" viewBox="0 0 75 125" style="border-radius:1px; " preserveAspectRatio="xMidYMid">  <path d="M 0 0 65 0 A 5 5 0 0 1 70 5 L 70 60 75 65 75 95 A 5 5 0 0 1 70 100 L 0 100 z" stroke="none" fill="url(#grad2)" />        <path d="M 0 0 0 100 30 125 30 90 33 85 33 25 z" stroke="none" fill="rgb(255, 233, 163)" />  </svg>'],
                
                files_image_icon:[
                    '<svg class="icon" viewBox="-1 -1 17 23" preserveAspectRatio="xMidYMid"><path d="M 0 0 10 0 15 5 15 21 0 21 z" stroke="rgb(135, 135, 135)" fill="rgb(255, 255, 255)" /><path d="M 10 0.5 10 5 14.5 5" stroke="rgb(135, 135, 135)" fill="rgb(230, 230, 230)"/><path d="M 3 8 12 8 12 17 3 17 z" stroke="rgb(0, 120, 215)" fill="none"/><path d="M 3 15 6 10 10.5 16 9 13 9.8 11.9 12 15 12 17 3 17 z" stroke="none" fill="rgb(0, 120, 215)"/></svg>'],
                
                files_data_icon:[
                    '<svg class="icon" viewBox="-1 -1 17 23" preserveAspectRatio="xMidYMid"> <path d="M 0 0 10 0 15 5 15 21 0 21 z" stroke="rgb(135, 135, 135)" fill="rgb(255, 255, 255)" /> <path d="M 10 0.5 10 5 14.5 5" stroke="rgb(135, 135, 135)" fill="rgb(219, 219, 219)"/> <path d="M 2 3 9.5 3 M 2 5 9.5 5 M 2 7 13 7 M 2 9 13 9 M 2 11 13 11 M 2 13 13 13 M 2 15 13 15 M 2 17 13 17" stroke="rgb(186, 186, 186)" fill="none"/> </svg>'],
                
                files_exe_icon:[
                    "<svg class='icon' viewBox='0 0 100 80' preserveAspectRatio='xMidYMid'><rect x='0' y='0' width='100' height='81' stroke='none' fill='rgb(133, 137, 140)' /><rect x='1' y='5' width='98' height='74' stroke='none' fill='white' /><path d='M 95.8 1.5 98 3.5 M 95.8 3.5 98 1.5 M 94 1.5 92 1.5 92 3.5 94 3.5 z M 87.5 3 90 3' stroke='white' fill='none' stroke-width='0.4'/><path d='M 1 12 1 5 99 5 99 12 z M 1 13 20 13 20 79 1 79 z' stroke='none' fill='rgb(230, 230, 230)'/><path d='M 2 10 7 10 M 2 8.5 7 8.6 M 2 7 7 7 M 94 7 91 7 91 10 94 10 z M 87 7 84 7 84 10 87 10 z M 4 18 7 18 7 21 4 21 z M 9 19.5 16 19.5 M 4 26 7 26 7 29 4 29 z M 9 27.5 16 27.5 M 4 34 7 34 7 37 4 37 z M 9 35.5 16 35.5 M 4 42 7 42 7 45 4 45 z M 9 43.5 16 43.5 M 4 50 7 50 7 53 4 53 z M 9 51.5 16 51.5 M 69 18 95 18 M 69 22 95 22 M 69 26 95 26 M 69 30 95 30 M 69 34 95 34 M 69 38 95 38 M 69 42 95 42 M 69 46 95 46 M 69 50 95 50 M 69 54 95 54 M 69 58 83 58' fill='none' stroke='rgb(152, 153, 154)' /><path d='M 23 15 65 15 65 70 23 70 z' fill='rgb(9, 125, 217)' stroke='none'/></svg>",
                    [14, 4, 2021]],
                
                files_text_icon:[
                    '<svg class="icon" viewBox="-1 -1 17 23" preserveAspectRatio="xMidYMid"> <path d="M 0 0 10 0 15 5 15 21 0 21 z" stroke="rgb(135, 135, 135)" fill="rgb(255, 255, 255)" /> <path d="M 10 0.5 10 5 14.5 5" stroke="rgb(135, 135, 135)" fill="rgb(219, 219, 219)"/> <path d="M 2 3 9.5 3 M 2 5 9.5 5 M 2 7 13 7 M 2 9 13 9 M 2 11 13 11 M 2 13 13 13 M 2 15 13 15 M 2 17 13 17" stroke="rgb(186, 186, 186)" fill="none"/> </svg>'],
                    
                files_js_icon:[
                    "<svg class='icon' viewBox='0 0 1100 1100' preserveAspectRatio='xMidYMid' style='border-radius:20%'> <rect width='100%' height='100%' fill='rgb(247, 223, 30)' /><path d='M965.9 801.1c-7.7-48-39-88.3-131.7-125.9-32.2-14.8-68.1-25.399-78.8-49.8-3.8-14.2-4.3-22.2-1.9-30.8 6.9-27.9 40.2-36.6 66.6-28.6 17 5.7 33.1 18.801 42.8 39.7 45.4-29.399 45.3-29.2 77-49.399-11.6-18-17.8-26.301-25.4-34-27.3-30.5-64.5-46.2-124-45-10.3 1.3-20.699 2.699-31 4-29.699 7.5-58 23.1-74.6 44-49.8 56.5-35.6 155.399 25 196.1 59.7 44.8 147.4 55 158.6 96.9 10.9 51.3-37.699 67.899-86 62-35.6-7.4-55.399-25.5-76.8-58.4-39.399 22.8-39.399 22.8-79.899 46.1 9.6 21 19.699 30.5 35.8 48.7 76.2 77.3 266.899 73.5 301.1-43.5 1.399-4.001 10.6-30.801 3.199-72.101zm-394-317.6h-98.4c0 85-.399 169.4-.399 254.4 0 54.1 2.8 103.7-6 118.9-14.4 29.899-51.7 26.2-68.7 20.399-17.3-8.5-26.1-20.6-36.3-37.699-2.8-4.9-4.9-8.7-5.601-9-26.699 16.3-53.3 32.699-80 49 13.301 27.3 32.9 51 58 66.399 37.5 22.5 87.9 29.4 140.601 17.3 34.3-10 63.899-30.699 79.399-62.199 22.4-41.3 17.6-91.3 17.4-146.6.5-90.2 0-180.4 0-270.9z' fill='#323330' /></svg>",
                    [31, 3, 2021]
                ],
                
                files_css_icon:[
                    "<svg class='icon' viewBox='0 0 1100 1100' preserveAspectRatio='xMidYMid' style='border-radius:20%'><rect width='100%' height='100%' rx='10' ry='10' fill='rgb(93, 180, 227)' /><path d='M 435 950 A 175 175 0 11 435 670 L 395 730 A 105 105 0 10 395 890' fill='#323330'/><path d='M 0 0 c-7.7-48-39-88.3-131.7-125.9-32.2-14.8-68.1-25.399-78.8-49.8-3.8-14.2-4.3-22.2-1.9-30.8 6.9-27.9 40.2-36.6 66.6-28.6 17 5.7 33.1 18.801 42.8 39.7 45.4-29.399 45.3-29.2 77-49.399-11.6-18-17.8-26.301-25.4-34-27.3-30.5-64.5-46.2-124-45-10.3 1.3-20.699 2.699-31 4-29.699 7.5-58 23.1-74.6 44-49.8 56.5-35.6 155.399 25 196.1 59.7 44.8 147.4 55 158.6 96.9 10.9 51.3-37.699 67.899-86 62-35.6-7.4-55.399-25.5-76.8-58.4-39.399 22.8-39.399 22.8-79.899 46.1 9.6 21 19.699 30.5 35.8 48.7 76.2 77.3 266.899 73.5 301.1-43.5 1.399-4.001 10.6-30.801 3.199-72.101z' transform='translate(703 874) scale(0.7)' fill='#323330'/><path d='M 0 0 c-7.7-48-39-88.3-131.7-125.9-32.2-14.8-68.1-25.399-78.8-49.8-3.8-14.2-4.3-22.2-1.9-30.8 6.9-27.9 40.2-36.6 66.6-28.6 17 5.7 33.1 18.801 42.8 39.7 45.4-29.399 45.3-29.2 77-49.399-11.6-18-17.8-26.301-25.4-34-27.3-30.5-64.5-46.2-124-45-10.3 1.3-20.699 2.699-31 4-29.699 7.5-58 23.1-74.6 44-49.8 56.5-35.6 155.399 25 196.1 59.7 44.8 147.4 55 158.6 96.9 10.9 51.3-37.699 67.899-86 62-35.6-7.4-55.399-25.5-76.8-58.4-39.399 22.8-39.399 22.8-79.899 46.1 9.6 21 19.699 30.5 35.8 48.7 76.2 77.3 266.899 73.5 301.1-43.5 1.399-4.001 10.6-30.801 3.199-72.101z' transform='translate(970 874) scale(0.7)' fill='#323330'/></svg>",
                    [31, 3, 2021]
                ],
                
                files_reload_icon:[
                    '<svg viewBox="0 0 824 1024" preserveAspectRatio="xMidYMid" fill="rgb(74, 74, 74)"><path transform="scale(1, -1) translate(0, -960)" d="M240.473-49.885c-12.832 0-25.664 8.213-30.284 21.301l-71.86 202.234c-6.159 16.425 2.566 34.39 18.478 40.549l190.941 73.656c16.425 6.929 35.16-1.283 41.576-17.965 6.159-16.425-2.053-35.16-18.735-41.576l-161.684-62.364 61.081-172.72c5.903-16.425-2.566-34.903-19.505-41.063-3.85-0.77-7.699-1.283-11.036-1.283zM463.238 605.835c-12.832 0-25.151 7.699-30.027 20.531-6.416 16.425 1.796 35.16 18.478 41.576l161.684 62.364-61.081 172.72c-5.903 16.682 2.566 35.16 19.505 41.063 16.682 5.903 35.16-2.566 41.063-19.505l71.86-202.234c5.646-16.425-2.566-34.39-18.991-40.549l-190.941-73.913c-3.85-1.283-7.699-2.053-11.549-2.053zM56.461 370.238c-15.398 0-29.514 11.806-31.567 28.231-2.053 16.168-3.080 32.85-3.080 49.532 0 215.066 175.030 390.095 390.095 390.095 98.037 0 191.968-36.443 264.341-102.657 12.832-12.319 13.602-32.593 1.54-45.682-11.549-12.832-31.824-13.859-44.912-1.796-60.311 55.435-138.586 85.975-220.712 85.975-179.649 0-325.935-146.286-325.935-325.935 0-13.859 1.027-28.231 2.566-41.576 2.566-17.452-10.266-33.363-27.461-35.93h-4.876zM411.14 57.905c-98.037 0-191.968 36.443-264.341 102.657-12.832 12.319-13.602 32.593-1.54 45.682 12.062 12.832 32.337 13.859 45.426 1.796 60.311-55.435 138.586-85.975 220.712-85.975 179.649 0 325.935 146.286 325.935 325.935 0 14.372-1.283 28.744-3.080 43.116-1.796 17.452 10.266 33.363 28.231 35.93 17.452 2.566 33.363-10.266 35.93-27.717 2.566-16.938 3.336-34.39 3.336-51.328 0-215.066-175.030-390.095-390.095-390.095z"/></svg>', [23, 3, 2021]
                ],
                
                
            //---------------------------//
                
                
                
                
            //---------ACE EDITOR--------//
                
                
                ACE_icon:[
                    "<svg class='icon' viewBox='-4 -4 108 88' preserveAspectRatio='xMidYMid'><rect x='0' y='0' width='100' height='80' rx='4%' ry='4%' stroke='url(#ace-grad)' stroke-width='8' /><text fill='url(#ace-invertgrad)' x='10' y='59' style='font-family:sans-serif; font-weight:700; font-size:55px; text-align:center;'>&lt;&sol;&gt;</text></svg>",
                [31, 3, 2021]
                
                ],
                
                
            //---------------------------//
            
            
            
                
            //--------HTML VIEWER--------//
            
                HTMLviewer_icon:[
                    "<svg class='icon' viewBox='-3 -3 106 106' preserveAspectRatio='xMidYMid' style='background-image:linear-gradient(rgb(244, 28, 255), rgb(255, 31, 31)); border-radius:12%;'><rect width='100px' height='100px' fill='none' stroke='rgb(240, 240, 240)' stroke-width='7px' rx='10' ry='10'/><path d='M 0 30 100 30' fill='none' stroke='rgb(240, 240, 240)' stroke-width='7px'/><path d='M 15 15 30 15 M 45 15 45 15 M 60 15 60 15' fill='none' stroke='rgb(240, 240, 240)' stroke-width='7px' stroke-linecap='round'/><path d='M 30 50 15 65 30 80 M 70 50 85 65 70 80 M 40 85 60 45' fill='none' stroke='rgb(240, 240, 240)' stroke-width='7px' stroke-linecap='round' stroke-linejoin='round'/></svg>",
                    [13, 4, 2021]
                ],
            
            //---------------------------//
            
            
            
            
            //----------NOTEPAD----------//
            
                notepad_icon:[
                    "<svg class='icon' viewBox='0 0 80 100' preserveAspectRatio='xMidYMid'><pattern id='notepadLines' patternUnits='userSpaceOnUse' width='4' height='8'><path d='M 0 4 4 4' stroke='rgb(127.5, 127.5, 127.5, 0.2)' stroke-width='1.5' /></pattern><path d='M 5 0 75 0 A 5 5 0 0 1 80 5 L 80 75 55 100 5 100 A 5 5 0 0 1 0 95 L 0 5 A 5 5 0 0 1 5 0 z' fill='rgb(255, 243, 196)' stroke='none'/><path d='M 5 0 75 0 A 5 5 0 0 1 80 5 L 80 75 55 100 5 100 A 5 5 0 0 1 0 95 L 0 5 A 5 5 0 0 1 5 0 z' fill='url(#notepadLines)' stroke='none'/><path d='M 80 75 55 75 55 100' fill='rgb(186, 173, 130)'/><path d='M 55 75 55 100 30 100' fill='rgb(0, 0, 0, 0.1)'/><path d='M 5 0 75 0 A 5 5 0 0 1 80 5 L 80 15 0 15 0 5 A 5 5 0 0 1 5 0' fill='rgb(194, 164, 119)' stroke='none'/><circle cx='20' cy='7.5' r='4' fill='rgb(230, 230, 230)' stroke='none'/><circle cx='60' cy='7.5' r='4' fill='rgb(230, 230, 230)' stroke='none'/><path d='M 10 15 14 15 14 100 10 100 z' fill='rgb(255, 102, 173, 0.3)'/></svg>",
                    [13,4,2021]
                ],
            
            //---------------------------//
          //webBrowser
          webBrowser: [
            `<svg viewBox="83.724 85.141 331.592 331.592" width="331.592" height="331.592">
  <circle style="fill: rgb(255, 255, 255); paint-order: stroke; stroke: rgb(0, 0, 0); stroke-width: 31px;" cx="248.629" cy="251.371" r="162.029"></circle>
  <path style="stroke: rgb(0, 0, 0); fill: none; stroke-width: 6px;" d="M 237.66 87.665 C 213.288 74.837 120.682 141.945 119.744 254.027 C 125.341 342.81 197.965 412.078 237.66 416.733"></path>
  <path style="stroke: rgb(0, 0, 0); fill: none; stroke-width: 6px;" d="M 375.229 415.125 C 350.857 427.953 258.251 360.845 257.313 248.763 C 262.91 159.98 335.534 90.712 375.229 86.057" transform="matrix(-1, 0, 0, -1, 632.541992, 502.744507)"></path>
  <path style="stroke: rgb(0, 0, 0); fill: none; stroke-width: 6px;" d="M 238.117 86.704 C 228.67 73.876 192.777 140.984 192.413 253.066 C 194.582 341.849 222.731 411.117 238.117 415.772"></path>
  <path style="stroke: rgb(0, 0, 0); fill: none; stroke-width: 6px;" d="M 294.79 414.209 C 286.855 427.037 256.704 359.929 256.399 247.847 C 258.221 159.064 281.866 89.796 294.79 85.141" transform="matrix(-1, 0, 0, -1, 551.188965, 500.912506)"></path>
  <path style="stroke: rgb(0, 0, 0); fill: none; stroke-width: 6px;" d="M 307.997 17.691 C 283.625 4.863 191.019 71.971 190.081 184.053 C 195.678 272.836 268.302 342.104 307.997 346.759" transform="matrix(0, 1, -1, 0, 430.482758, -67.595261)"></path>
  <path style="stroke: rgb(0, 0, 0); fill: none; stroke-width: 6px;" d="M 308.043 482.766 C 283.671 495.594 191.065 428.486 190.127 316.404 C 195.724 227.621 268.348 158.353 308.043 153.698" transform="matrix(0, -1, 1, 0, -69.928261, 568.098267)"></path>
  <path style="stroke: rgb(0, 0, 0); fill: none; stroke-width: 6px;" d="M 272.852 54.254 C 263.405 41.426 227.512 108.534 227.148 220.616 C 229.317 309.399 257.466 378.667 272.852 383.322" transform="matrix(0, 1, -1, 0, 468.006714, -31.993263)"></path>
  <path style="stroke: rgb(0, 0, 0); fill: none; stroke-width: 6px;" d="M 269.196 442.089 C 261.261 454.917 231.11 387.809 230.805 275.727 C 232.627 186.944 256.272 117.676 269.196 113.021" transform="matrix(0, -1, 1, 0, -28.335762, 528.336792)"></path>
</svg>`
          ],
        }
        
        
        var exeFile = { 
            
            photos:[function(){ 
                
                loadCSS(filePath.wholePath('./photos_style.css'))
                
                if(openedFileContext == undefined || openedFileContext == ""){ 
                    openFile('C:/Windows/Base/Popup/Popup.exe', ["popup", "No file selected to be viewed", "error", null, null])
                    return;
                }
                
                var fileOpened = openedFileContext
                
                var imageDisplayed = filePath.all(fileOpened)
                
                { 
                
                var fol = filePath.folder(fileOpened)
                
                var w = filePath.data(fol)
                
                }//image folder
                
                //Index image lalli embayen
                var imageIndex = Object.keys(w).indexOf(imageDisplayed.name + '.' + imageDisplayed.type);
                
                
                
                
                
    applicationHolder({ 
        'background-color':'black',
    }, directory)
    var n = '#application-' + (openedScreens-1)
    var a = $(n + " > .app")
    a.append('<div class="photo-top"><div class="photo-top-date">' + dateString(imageDisplayed.date) + ' - ' + fileOpened.split('/')[fileOpened.split('/').length - 1] +  '</div><div class="photo-top-trash button-style">' + filePath.data('./trash-image.svg') + '</div></div>')
    a.append('<div class="photo-main"><img class="photo-main-photo" src=""><div class="photo-main-left"><svg width="25" height="25"><path d="M 16 6 8 12.5 16 18.5" stroke="white" stroke-width="3" fill="none" ></svg></div><div class="photo-main-right"><svg width="25" height="25"><path d="M 9 6 17 12.5 9 18.5" stroke="white" stroke-width="3" fill="none"></svg></div></div>')
    
    function update_con(){ 
        $(n + " .photo-top-date").html(dateString(imageDisplayed.date) + ' - ' + Object.keys(w)[imageIndex])
        
        $(n + " .photo-main-photo").attr('src', imageDisplayed.data)
    }
    update_con() //Update content (imageDisplayed and date)
    
    $(n + ' .photo-main-right').click(function(){ 
        
        //Problem with file mixed with image files and other types, but too lazy to change it works fine just need to click button more than once
        
        if(imageIndex == Object.size(w)-1){ 
            imageIndex = 0
        }else{ imageIndex ++}
        
        imageDisplayed = filePath.all(fol + '/' + Object.keys(w)[imageIndex])
        
        update_con()
    })
    
    $(n + ' .photo-main-left').click(function(){ 
        if(imageIndex == 0){ 
            imageIndex = Object.size(w)-1
        }else{ imageIndex -- }
        
        imageDisplayed = filePath.all(fol + '/' + Object.keys(w)[imageIndex])
        
        update_con()
    })
    
    $(n + ' .photo-top-trash').click(function(){ 
        deleteFile(fol + "/" + Object.keys(w)[imageIndex])
        $(n + ' .photo-main-right').click()
    })
    
    }],
            
            popup:[function(){ 
                
                loadCSS(filePath.wholePath('./popup_style.css'))
                
                var txt = (filePath.data('./context.dat'))[0]
                var type = (filePath.data('./context.dat'))[1]
                
                var savedCont = filePath.data('./context.dat')
                var fCanc = savedCont[2] || function(){ return;}
                var fOk = savedCont[3] || function(){ return;}
                
                
                
                { 
                applicationHolder(
                    { 
                        "background-color":"rgb(247, 247, 247)",
                        "width":"350px",
                        "height":"220px",
                        "min-height":"170px",
                        "left": "calc(50% - 175px)",
                        "top": "calc(50% - 120px)"
                    },
                    directory,
                    { minimize:false, maximize:false, close:true}
                )
                }//Call appHolder()
                
                var n = "#application-" + (openedScreens-1)
                var a = n + ' > .app'
                
                
                
                $(a)
                .css('background-color', 'rgb(247, 247, 247)')
                .append('<div class="popup-wrapper"><div class="popup-content"><div class="popup-content-image">' + (filePath.data('./' + type + '.svg')) + '</div><div class="popup-content-text">' + txt + '</div></div><div class="popup-bottom"><div class="popup-bottom-button" num="1">Cancel</div><div class="popup-bottom-button" num="2">Ok</div><div class="popup-bottom"></div></div>')
                
                if(type !== "warning"){ 
                    $(n + ' .popup-bottom-button').first().css('display', 'none')
                }
                
                
                
                
                
                $(n + ' .popup-bottom-button').click(function(){ 
                    if($(this).attr('num') == "1"){ 
                        fCanc()
                    }
                    else{ 
                        fOk()
                    }
                    $(n + ' .close-button').click()
                    
                })
                
            }],
            
            subPopup:[function(){ 
                
                loadCSS(filePath.wholePath('./subPopup_style.css'))
                
                { 
                applicationHolder(
                    { 
                        "background-color":"rgb(247, 247, 247)",
                    },
                    directory,
                    { minimize:true, maximize:false, close:true}
                )
                }//Call appHolder()
                
                var n = "#application-" + (openedScreens-1)
                var a = n + ' > .app'
                
                var cont = filePath.data('./context.dat')
                
                
                if(cont[1] == "input"){ 
                    
                    $(a).append('<div class="subPopup-wrapper"><div class="subPopup-input-title">' + cont[0] + '</div><div class="subPopup-input-field"><input class="subPopup-input-input"></input></div><div class="subPopup-input-bottom"><div class="subPopup-button" num="1">Cancel</div><div class="subPopup-button" num="2">Ok</div></div></div>')
                    
                    $(n).css({ 
                        "height":"125px",
                        "min-height":"125px"
                    })
                    $(n + ' .subPopup-input-input').first().focus()
                    
                    var fCanc = cont[2] || function(){ return;}
                    var fOk = cont[3] || function(){ return;}
                    
                    $(n + ' .subPopup-button').click(function(){ 
                        var inputVal = $(a + ' .subPopup-input-input').first().val()
                        
                        if($(this).attr('num') == "1"){ 
                            fCanc(inputVal)
                        }
                        else{ 
                            fOk(inputVal)
                        }
                        
                        $(n + ' .close-button').click()
                    })
                    
                }
                if(cont[1] == "custom"){ 
                    $(a).append(cont[0])
                }
                
                
            }],
            
            fileexplorer:[function(){ 
                
                applicationHolder({ 
                    "background-color":"rgb(255,255,255)",
                    "width": "330px",
                    "height": "230px"
                }, directory)
                
                eval(filePath.data('./treeview.js'))//import js
                loadCSS(filePath.wholePath('./files_style.css'))//load css
                
                var n = "#application-" + (openedScreens-1)
                var a = n + ' > .app'
                
                
                
                //Folder? yes = this, no = default
                if(openedFileContext !== undefined && openedFileContext !== ""){ 
                    var folderLoc = filePath.type(openedFileContext) == "File folder" ? openedFileContext : (filePath.data('./folderLoc.dat'))[0]
                }
                else{ 
                    var folderLoc = (filePath.data('./folderLoc.dat'))[0]
                }
                
                
                
                //exist? no = this = default
                if(openedFileContext == ""){ 
                    folderLoc = (filePath.data('./folderLoc.dat'))[0]
                }
                openedFileContext = "" //reset
                
                
                
                //exist? yes = this, no = path
                var openedFolder = folderLoc ?  folderLoc : "C:/Users"
                
                
                var savedDir = directory;
                    savedDir = filePath.folder(savedDir)
                //save directory 3ashan el same folder path
                
                
                
                
                
                
                $(a).append('<div class="files-wrapper"><div class="files-top-directory"><div class="files-top-directory-back"></div><div class="files-top-directory-path"></div><div class="files-top-directory-refresh">' + (filePath.data('./reload_icon.svg')) + '</div></div><div class="files-top"> <div class="files-top-struc"><ol class="files-top-struc-ol"></ol></div> <div class="files-top-cont"></div> </div> <div class="files-bottom"> <div class="files-bottom-svg">' + (filePath.data('./folder_icon.svg')) + '</div> <div class="files-bottom-name"></div> <div class="files-bottom-data"></div> </div> </div>')
                
                $(a + ' .files-top-directory-back').append('<svg width="20" height="20"><path d="M 14 6 6 12.5 14 18.5" stroke="rgba(0,0,0,0.3)" stroke-width="2" fill="none"></svg>')
                
                
                { 
                    $(n + ' .files-top-directory-back').click(function(){ 
                        if(openedFolder.split('/').length > 1){ 
                            openedFolder = filePath.folder(openedFolder)
                            update()
                        }
                    })
                }//top-directory-back
                
                
                { 
                    
                
                treeview(FILESYSTEM, $(n + ' .files-top-struc-ol'))
                
                $(n + ' .files-top-struc-ol li').prepend(filePath.data('./folder_icon.svg') + ' ')
                
                
                var allfolders = $(n + ' .files-top-struc-ol li > ol')
                allfolders.each(function(){ 
                
                { 
                    
                     
                    var folderAndName = $(this).parent();
                    

                    // backup this inner <ul>
                    var backupOfThisFolder = $(this);
                    
                    // then delete it
                    $(this).remove();
                    
                    folderAndName
                    .addClass("folder")// add the folder class to the parent <li>
                    .wrapInner("<a>")// add an <a> tag to whats left ie. the folder name
                    .wrapInner("<div>") //(for opening folder)
                    
                    // <div> <a> ... </a> </div> ...
                    
                    
                    // then put the inner <ul> back
                    
                    folderAndName.append(backupOfThisFolder);
                    
                    // now add a slideToggle to the <a> we just added
                    folderAndName.find('div').find("a").click(function(e) { 
                        
                        $(this).parent().siblings("ol").slideToggle("medium");
                        e.preventDefault();
                        
                    });
                    
                    folderAndName.find('div').click(function() { 
                        openedFolder = ($(this).parent().attr('dir_'))
                        
                        update()
                        
                    })//Open folder
                    
                }
                
                })//Collapse Folders (and openFolder)
   
   
   
                { 
                    var classFolder = $(n + " .folder")
                    classFolder.each(function(){ 
                        var p = $(this).attr('dir_name')
                        for(var z = 0; z < $(this).parents('.folder').length; z ++){ 
                            p = $($(this).parents('.folder')[z]).attr('dir_name') + '/' + p
                            
                        }
                        
                        
                        $(this).attr('dir_', p)
                    })
                }//Add directory as attribute
                
                
                
                }//Directory Treeview (struc)
                
                
                { 
                
                { 
                    
                function loadFile(name, ty, oW){ 
                         //ty = type   
                         //oW = open with
                         
                         oW = oW || undefined
                    if(ty !== "File folder"){ 
                        openFile(openedFolder + '/' + name, [], oW)
                    }
                    else{ 
                        if(oW == undefined){ 
                            openedFolder += "/" + name
                            
                            update()
                        }
                        else{ 
                            openFile(openedFolder + '/' + name, [], oW)
                        }
                    }
                    
                }   
                
                }//loadFile()
                { 
                    function switchSelected(elem){ 
                        $(n + ' .files-selected').removeClass('files-selected')
                        elem.addClass('files-selected')
                    }
                }//switch files-selected()
                
                function update(){ 
                    
                    $(n + ' .files-top-cont')
                    .empty()
                    .append('<div class="files-top-cont-files"></div><div class="files-top-cont-emptyspace"></div>')
                    
                    $(n + ' .files-bottom-name')
                    .empty()
                    .append(filePath.name(openedFolder))
                    
                    $(n + ' .files-top-directory-path')
                    .empty()
                    .append(openedFolder)
                    
                    { 
                    if(Object.size(filePath.data(openedFolder)) == 0){ 
                        $(n + ' .files-top-cont-files').append('<div class="files-top-cont-files-empty">Folder is empty</div>')
                        
                    }
                    }//Display "Folder is empty"
                    
                    { 
                    { 
                    
                    var fileMenu = [
                        { 
                            "text": "Open",
                            "action": function(){ 
                                $(n + ' .files-selected').each(function(){ 
                                    var esm = $(this).find('.files-cont-item-name').text() //esim el folder
                                    if($(this).attr('filetype') !== "File folder"){ 
                                        
                                        loadFile(esm, $(this).attr('filetype'))
                                    }
                                    else{ 
                                        
                                        if($(n + ' .files-selected').length > 1){ 
                                        openFile('C:/Windows/Main/File_Explorer/Files.exe', ['fileexplorer', $(this).attr('dir')])
                                        update()
                                        }
                                        else{ 
                                            loadFile(esm, "File folder")
                                        }
                                        
                                    }
                                })
                                
                                
                            },
                        }, //Open
                        { 
                            "text": "Open in new window",
                            "action": function(){ 
                                $(n + ' .files-selected').each(function(){ 
                                    
                                    if($(this).attr('filetype') == "File folder"){ 
                                        openFile($(this).attr('dir'), undefined, 'C:/Windows/Main/File_Explorer/Files.exe')
                                        update()
                                    }
                                    
                                })
                                
                            },
                        }, //Open in new window
                        { 
                            "text": "Open with",
                            "sub": [],
                            "divider":true,
                        }, //Open with --- (sub) (divider)
                        { 
                            "text": "Send to",
                            "sub": [
                                { 
                                    "text": "Compressed folder",
                                    "action": function(){ },
                                }, //Compressed folder
                                { 
                                    "text": "Desktop (shortcut)",
                                    "action": function(){ 
                                        var dir = contextmenuEle.attr('dir')
                                        createFile('C:/Users/Me/Desktop', filePath.name(dir) + '.lnk', dir)
                                        refreshDesktop()
                                    },
                                }, //Desktop shortcut
                            ],
                            "divider": true,
                        }, //Send to --- (sub) (divider)
                        { 
                            "text": "Cut",
                            "action": function(){ 
                                var r = $(n + ' .files-selected').map(function(){ 
                                    return ($(this).attr('dir'))
                                })
                                copyFile(r, function(ln){ deleteFile(ln)})
                                
                                
                                update()
                            },
                        }, //Cut
                        { 
                            "text": "Copy",
                            "action": function(){ 
                                var r = $(n + ' .files-selected').map(function(){ 
                                    return ($(this).attr('dir'))
                                })
                                copyFile(r)
                            },
                            "divider": true,
                        }, //Copy --- (divider)
                        { 
                            "text": "Create shortcut",
                            "action": function(){ 
                                var d = filePath.name(contextmenuEle.find('.files-cont-item-name').text()) //esim el folder
                                createFile(openedFolder, d + ' - shortcut.lnk', contextmenuEle.attr('dir'))
                                update()
                            },
                        }, //Create shortcut
                        { 
                            "text": "Delete",
                            "action": function(){ 
                                $(n  + ' .files-selected').each(function(){ 
                                    deleteFile($(this).attr('dir'))
                                })
                                
                                update()
                            },
                        }, //Delete
                        { 
                            "text": "Rename",
                            "action": function(){ 
                                openFile('C:/Windows/Base/Sub_Popup/Sub_Popup.exe', ['C:/Windows/Base/Sub_Popup/context.dat', 'Rename file', 'input',
                                null,
                                function(a){ 
                                    $(n + ' .files-selected').each(function(){ 
                                        renameFile($(this).attr('dir'), a, update)
                                    })
                                }])
                            },
                            "divider": true,
                        }, //Rename (divider)
                        { 
                            "text": "Properties",
                            "action": function(){ 
                                
                                openFile('C:/Windows/Base/Sub_Popup/Sub_Popup.exe', ['C:/Windows/Base/Sub_Popup/context.dat', 
                            filePath.data(savedDir + '/fileProperties.html'),
                            
                            'custom'])
                            },
                        }, //Properties
                    ]
                    
                    }//fileMenu[]
                    
                    savedFileMenu = []//fileMenu cloned
                    
                    }//context-menu for items
                    
                    for(var ind = 0; ind < Object.size(filePath.data(openedFolder)); ind++){ 
                    
                        // ind = index
                        // s = name of item in object
                        var s = Object.keys(filePath.data(openedFolder))[ind]
                        var sPath = openedFolder + '/' + s
                        
                        { 
                        if(s.match(/[.]/g) !== null){ 
                            type = (filePath.type(s)).toUpperCase() + ' file'
                        }else{ 
                            type = "File folder"
                        }
                        
                        }//File type
                        { 
                            
                            if(filePath.data(sPath) !== undefined){ 
                                var date = dateString(filePath.date(sPath))
                            }
                            else{ 
                                var date = ""
                            }
                        }//File date
                        
                        $(n + ' .files-top-cont-files').append('<div class="files-cont-item files-cont-item-' + ind + '" filetype="' + type + '" dir="' + openedFolder+'/'+ s + '" index=' + ind + '><div class="files-cont-item-values files-cont-item-name">' + s + '</div><div class="files-cont-item-values files-cont-item-date">' + date + '</div><div class="files-cont-item-values files-cont-item-type">' + type + '</div></div>')
                        
                        
                        { 
                            
                            
                            { 
                            var fOp = filePath.data('C:/Windows/Source/Filetype_Openers.dat')
                            var dOp = filePath.data('C:/Windows/Source/Datatype_Openers.dat')
                            var prog = []//programs capable of opening
                            
                            { 
                            var m = dOp[typeof filePath.data(sPath)]
                            if(m !== undefined){ 
                                for(var v = 0; v < m.length; v ++){ 
                                    prog.push(m[v])
                                }
                            }
                            }//dOP
                            { 
                            var l = fOp[filePath.type(s)]
                            if(l !== undefined){ 
                                for(var v = 0; v < l.length; v ++){ 
                                    if(prog.indexOf(l[v]) == -1){ 
                                        prog.push(l[v])
                                    }
                                }
                            }
                            }//fOp
                            
                            $(n + ' .files-cont-item-' + ind).attr('openwith', prog)
                            
                            if(prog.length > 0){ 
                                
                                fileMenu[2].enabled = true
                                for(var d = 0; d < prog.length; d ++){ 
                                    var sel = prog[d]
                                    fileMenu[2].sub[d] = { 
                                        "text": filePath.name(sel),
                                        
                                        "assigned": sel,//3ashan action bya5oth a5er value la *d*  (mish contextmenu attribute)
                                        
                                        "action": function(){ 
                                            var f = contextmenuEle.find('.files-cont-item-name').text() //esim el folder
                                    
                                        loadFile(f, contextmenuEle.attr('filetype'), this.assigned)
                                        }
                                    }
                                    
                                }
                                
                            }
                            else{ 
                                fileMenu[2].enabled = false
                            }
                            
                            }//Open with
                            
                            
                            
                            
                            function changeContMen(menu){ 
                                
                                
                                if($('.files-selected').length < 2){ 
                                    switchSelected(contextmenuEle)
                                }
                                
                                var hasFolder = false, hasFile = false;
                                
                                $(n + ' .files-selected').each(function(){ 
                                    
                                    if($(this).attr('filetype') == "File folder"){ 
                                        hasFolder = true
                                    }
                                    else{ 
                                        hasFile = true
                                    }
                                    
                                    
                                })
                                if(!hasFolder){ 
                                    menu[1].enabled = false
                                }
                            }
                            
                            
                            savedFileMenu = deepClone(fileMenu)//3ashan fileMenu 3endo refrences fa bet3'ayar
                            
                            
                            contextMenu('contextMenu', savedFileMenu, n + ' .files-cont-item-' + ind, changeContMen)    
                            
                        }//Context-menu
                        
                        { 
                            
                            $(n + ' .files-cont-item-' + ind).prepend('<div class="files-cont-item-svg">'+fileIcon(sPath)+'</div>')
                            
                        }//Add icon
                        
                        { 
                            $(n + ' .files-cont-item-'+ind).tooltip('File type: ' + type + '<br>File name: ' + s + '<br>Data-type: ' + typeof filePath.data($(n + ' .files-cont-item-'+ind).attr('dir')))
                        }//tooltip   
                        
                        
                    }
                    
                    
                    { 
                        var emptyspaceMenu = [
                            
                            { 
                                "text": "Refresh",
                                "action": function(){ 
                                    update()
                                },
                                "divider": true
                            }, //Refresh --- (divider)
                            { 
                                "text": "Paste",
                                "action": function(){ 
                                    pasteFile(openedFolder)
                                    update()
                                },
                                "divider": true,
                            }, //Paste --- (divider)
                            { 
                                "text": "New",
                                "sub": [
                                    
                                    { 
                                        
                                        "text": "Folder",
                                        "action": function(){ 
                                            createFile(openedFolder, "New folder", { })
                                            update()
                                        }
                                        
                                    }, //Folder
                                    { 
                                        
                                        "text": "Shortcut",
                                        "action": function(){ 
                                            openFile('C:/Windows/Base/Sub_Popup/Sub_Popup.exe', ['C:/Windows/Base/Sub_Popup/context.dat', 'File directory i.e: (C:/Users)', 'input',
            null,
            function(a){ 
                if(filePath.data(a) !== undefined){ 
                    createFile(openedFolder, filePath.name(a)+'.lnk', a)
                }
                else{ 
                    openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', 'The file ' + a + ' cannot be found', 'error'])
                }
                update()
            }])
                                        },
                                        "divider": true
                                        
                                    }, //Shortcut --- (divider)
                                    { 
                                        "text": "String based (.txt)",
                                        "action": function(){ 
                                            createFile(openedFolder, "New Text Document.txt", "Text File")
                                            update()
                                        }
                                    }, //String based
                                    { 
                                        "text": "Object based (.dat)",
                                        "action": function(){ 
                                            createFile(openedFolder, "New Data File.dat", { })
                                            update()
                                        }
                                    }, //Object based
                                    { 
                                        "text": "Javascript function based (exe)",
                                        "action": function(){ 
                                            createFile(openedFolder, "New Executable File.exe", function(){ })
                                            update()
                                        },
                                        "divider": true,
                                    }, //JS function based --- (divider)
                                    { 
                                        "text": "HTML file (string based)",
                                        "action": function(){ 
                                            createFile(openedFolder, "New HTML File.html", "<!doctype html>\n<html>\n\t<head>\n\t\t<style></style>\n\t</head>\n\t<body></body>\n</html>")
                                            update()
                                        },
                                    }, //HTML
                                    { 
                                        "text": "CSS file (string based)",
                                        "action": function(){ 
                                            createFile(openedFolder, "New CSS File.css", "body{ \n\tbackground-color: red;\n}")
                                            update()
                                        },
                                    }, //Javascript
                                    { 
                                        "text": "Javascript file (string based)",
                                        "action": function(){ 
                                            createFile(openedFolder, "New Javascript File.js", "\/\/Right click for OS functions")
                                            update()
                                        },
                                    }, //Javascript
                                ]
                            } //New --- (sub)
                            
                        ]
                        contextMenu('contextMenu', emptyspaceMenu, n + ' .files-top-cont-emptyspace')
                        
                        $(n + ' .files-top-cont-emptyspace').click(function(){ 
                            
                            $(n + ' .files-selected').removeClass('files-selected')
                            
                        })
                        
                    }//context menu for folder and remove files-selected onclick
                    
                    
                    { 
                    var itemOrItems = $('.files-cont-item').length !== 1 ? 'items' : 'item'
                    
                    $(n + ' .files-bottom-data')
                    .empty()
                    .append('- ' + $('.files-cont-item').length + ' ' + itemOrItems)
                    }//bottom-data (ta7t hon 3ashan lazemlo .files-cont-item)
                    
                    
                    { 
                    $(n + ' .files-cont-item')
                    .dblclick(function(){ 
                        loadFile($(this).find('.files-cont-item-name').text(), $(this).attr('filetype'))
                    })
                    .click(function(e){ 
                        
                        if(e.shiftKey && $(n + ' .files-selected').length > 0){ 
                            
                            var a = Number($(n + ' .files-selected').first().attr('index'))
                            var b = Number($(this).attr('index'))
                            
                            var aw6a = Math.min(a, b)

                            for(var s = aw6a; s < aw6a+Math.abs(b - a)+1; s ++){ 
                                $(n + ' .files-cont-item[index=' + s + ']').addClass('files-selected')
                            }
                            
                        }
                        else if(e.ctrlKey){ 
                            $(this).addClass('files-selected')
                        }
                        else{ 
                            switchSelected($(this))
                        }

                    })
                    }//Open File and multiselect
                    
                    
                }
                update()
                
                $(n + ' .files-top-directory-refresh').click(update)
                
                }//Folder Content (cont)
                
                
                { 
                    
                    $(n + ' .files-top-directory-refresh').tooltip('Refresh content')
                    
                    $(n + ' .files-top-directory-back').tooltip('Parent folder')
                    
                }//Some tooltips
                
            }],
            
            notepad : [function(){ 
                
                //Notepad befta7 kol el string files (not obj, array, etc)
                
                { 
                var txtValueF, savedDir
                if(openedFileContext !== "" && openedFileContext !== undefined){ 
                    
                    txtValueF = filePath.data(openedFileContext)
                    
                    if(typeof txtValueF !== "string"){ 
                        
                        openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', 'File datatype is ' + typeof txtValueF + ', Notepad only opens strings', 'error', null, null])
                        return;
                    }
                    
                    //save it
                    savedDir = openedFileContext
                    
                    //3ashan etha kan jdeed, ma yerod yefta7ha
                    openedFileContext = ''
                
                }
                }//txtValue if opened file
                
                var txtValue = txtValueF ? txtValueF : ''
                
                
                loadCSS(filePath.wholePath('./notepad_style.css'))
                applicationHolder({ 
                    'background-color':'rgb(255,255,255)',
                    'width':'300px',
                    'height':'200px',
                }, directory)
                
                
                var n = "#application-" + (openedScreens-1)
                var a = n + ' > .app'
                
                
                $(a).append('<div class="notepad-wrapper"><div class="notepad-top"><div class="notepad-top-button notepad-top-file">File</div><div class="notepad-top-button notepad-top-format">Format</div><div class="notepad-top-button notepad-top-view">View</div></div><div class="notepad-bottom"><textarea class="notepad-bottom-main" styleD="default">' + txtValue + '</textarea></div></div>')
                
                var c = n + ' .notepad-bottom-main' 
                
                var fileMenu = [
                    { 
                        "text": "New",
                        "action": function(){ 
                            //maybe temp maybe not
                            $(n + ' .close-button').click()
                            openFile('C:/Program_Files/Notepad/Notepad.exe')
                        }
                    }, //New
                    { 
                        "text": "Open",
                        "action": function(){ },
                        "divider": true,
                    }, //Open
                    { 
                        "text": "Save",
                        "action": function(){ 
                            saveFile(savedDir, $(n + ' .notepad-bottom-main').val())
                        },
                        "enabled": savedDir ? true : false
                    }, //Save
                    { 
                        "text": "Save As",
                        "action": function(){ 
                            saveAsFile('Text file.txt', $(n + ' .notepad-bottom-main').val(), function(path){ 
                                savedDir = path
                            })
                        }
                    }, //Save as
                ]
                var formatMenu = [
                    { 
                        "text": "Word Wrap",
                        "action": function(){ 
                            $(c).toggleClass('notepad-wordwrap')
                        },
                    }, //Word Wrap
                    { 
                        "text": "Font",
                        "sub": [
                            { 
                                "text": "Monospace",
                                "action": function(){ 
                                    $(c).css('font-family', 'monospace')
                                }
                            },
                            { 
                                "text": "Sans-serif",
                                "action": function(){ 
                                    $(c).css('font-family', 'sans-serif')
                                }
                            },
                            { 
                                "text": "Serif",
                                "action": function(){ 
                                    $(c).css('font-family', 'serif')
                                }
                            },
                        ],
                    } //Font
                ]
                var viewMenu = [
                    { 
                        "text": "Styles",
                        "sub": [
                            { 
                                "text": "Default",
                                "action": function(){ 
                                    $(c).attr('styleD', 'default')
                                },
                            }, //Default
                            { 
                                "text": "Invert",
                                "action": function(){ 
                                    $(c).attr('styleD', 'invert')
                                },
                            }, //Invert
                            { 
                                "text": "Uhhhh",
                                "action": function(){ 
                                    $(c).attr('styleD', 'gradient')
                                },
                            }, //Uhhhh
                            { 
                                "text": "Hacker",
                                "action": function(){ 
                                    $(c).attr('styleD', 'hacker')
                                },
                            }, //Hacker
                        ]
                    } //Styles
                ]
                
                contextMenu('click', fileMenu, n + " .notepad-top-file")
                contextMenu('click', formatMenu, n + " .notepad-top-format")
                contextMenu('click', viewMenu, n + " .notepad-top-view")
                
            }],
            
            ACEeditor : [function(){ 
                
                loadCSS(filePath.wholePath('./ACEeditor_style.css'))
                
                applicationHolder({ 
                    'background-color':'rgb(50, 50, 50)'
                }, directory)
                
                var n = "#application-" + (openedScreens-1)
                var a = n + ' > .app'
                
                var val = ""
                var editMode = "javascript"
                
                if(openedFileContext){ 
                    var d = filePath.data(openedFileContext)
                    var t = typeof d
                    
                    if(t == "string"){ 
                        val = d
                        editMode = "text"
                    }
                    else if(t == "object" || t == "boolean" || t == "number"){ 
                        val = JSON.stringify(d, null, 4)
                        editMode = "javascript"
                    }
                    else if(t == "function" || t == "bigint"){ 
                        val = d.toString()
                        editMode = "javascript"
                    }
                    else if(t == "undefined" || t == "null"){ 
                        editMode = "javascript"
                        val = ""
                    }
                    else{ 
                        openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', 'ACEeditor does not open this datatype (' + typeof txtValueF + ')', 'error', null, null])
                        return;
                    }
                    
                    var savedDir = openedFileContext
                    openedFileContext = undefined
                }
                
                var exten = savedDir ? filePath.type(savedDir) : 'js'    
                if(exten == 'js' || exten == 'dat' || exten == 'exe'){ editMode = "javascript"}
                
                if(exten == 'html' || exten == 'svg'){ editMode = "html"}
                if(exten == 'css'){ editMode = "css"}
                
                
                $(a).append('<div class="ACEeditor-wrapper"><div class="ACEeditor-top">\
                <div class="ACEeditor-top-button ACEeditor-button-file">File</div>\
                <div class="ACEeditor-top-button ACEeditor-button-format">Format</div>\
                <div class="ACEeditor-top-button ACEeditor-button-view">View</div>\
                <div class="ACEeditor-top-button ACEeditor-button-aceeditor">ACEeditor</div>\
                \
                </div>\
                <div class="ACEeditor-bottom"><div class="ACEeditor-editor" id="ACE-' + openedScreens + '"></div></div></div>')
                
                
                var editor = ace.edit("ACE-"+openedScreens);
                editor.setTheme("ace/theme/chaos");
                editor.session.setMode("ace/mode/" + editMode);
                
                
                editor.setValue(val)
                $(n).click(function(){ 
                    editor.resize()
                })
                
                
                function getACEVal(){ 
                    if(savedDir !== undefined){ 
                        var t = typeof filePath.data(savedDir)
                    }
                    else{ 
                        var t = 'string'
                    }
                    
                    if(t == "string"){ 
                        return editor.getValue()
                    }
                    else if(t == "object"){ 
                        
                        
                            return JSON.parse(editor.getValue())
                            
                        
                        
                    } 
                    else if(t == "boolean"){ 
                        return editor.getValue() == 'true'
                    }
                    else if(t == "number"){ 
                        return Number(editor.getValue())
                    }
                    else if(t == "function"){ 
                        return eval('(' + editor.getValue() + ')')
                    }
                    else if(t == "bigint"){ 
                        return BigInt(editor.getValue())
                    }
                    else if(t == "undefined" || t == "null"){ 
                        return editor.getValue()
                    }
                    
                }
                
                var fileMenu = [
                    { 
                        "text": "New",
                        "action": function(){ 
                            //maybe temp maybe not
                            $(n + ' .close-button').click()
                            openFile('C:/Program_Files/ACEeditor/ACEeditor.exe')
                        }
                    }, //New
                    { 
                        "text": "Open",
                        "action": function(){ },
                        "divider": true,
                    }, //Open
                    { 
                        "text": "Save",
                        "action": function(){ 
                            
                            var t = typeof filePath.data(savedDir)
                            
                            if(t == "object"){ 
                                openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', 'ACEeditor uses JSON.stringify to open objects, if file contains non-json data it is advised not to save.<br><b>Continue to save?</b>', 'warning',
                                null,
                                function(){ 
                                    saveFile(savedDir, getACEVal())
                                }])
                            }
                            else{ 
                                saveFile(savedDir, getACEVal())
                            }
                        
                        },
                        "enabled": savedDir ? true : false
                    }, //Save
                    { 
                        "text": "Save As",
                        "action": function(){ 
                            saveAsFile('ACEeditor file.txt', getACEVal(), function(path){ 
                                savedDir = path
                            })
                        }
                    }, //Save as
                ]
                var formatMenu = [
                    { 
                        "text": "Javascript beautify",
                        "action": function(){ 
                            
                            editor.setValue(js_beautify(editor.getValue()))
                        },
                    }, //JS beautify
                    { 
                        "text": "HTML beautify",
                        "action": function(){ 
                            
                            editor.setValue(html_beautify(editor.getValue()))
                        },
                    }, //HTML beautify
                    { 
                        "text": "CSS beautify",
                        "action": function(){ 
                            
                            editor.setValue(css_beautify(editor.getValue()))
                        },
                        "divider": true,
                    }, //CSS beautify --- (divider)
                    { 
                        "text": "Word Wrap",
                        "action": function(){ 
                            if(editor.getSession().getUseWrapMode()){ 
                                editor.getSession().setUseWrapMode(false);
                            }
                            else{ 
                                editor.getSession().setUseWrapMode(true);
                            }
                        },
                    }, //Word Wrap
                    { 
                        "text": "Indent Word Wrap",
                        "action": function(){ 
                            if(editor.getOption("indentedSoftWrap")){ 
                            editor.setOption("indentedSoftWrap", false);
                            }
                            else{ 
                                editor.setOption("indentedSoftWrap", true);
                            }
                        },
                        "divider": true,
                    }, //Indent word wrap --- (divider)
                    { 
                        "text": "Fold all",
                        "action": function(){ 
                            editor.getSession().foldAll()
                        }
                    }, //Fold all
                    { 
                        "text": "Unfold all",
                        "action": function(){ 
                            editor.getSession().unfold(1, true)
                        },
                        "divider": true,
                    }, //Unfold all --- (divider)
                    { 
                        "text": "Syntax mode",
                        "sub": [
                            { 
                                "text": "Javascript",
                                "action": function(){ 
                                    editor.session.setMode("ace/mode/javascript");
                                },
                            }, //Javascript
                            { 
                                "text": "HTML",
                                "action": function(){ 
                                    editor.session.setMode("ace/mode/html");
                                },
                            }, //HTML
                            { 
                                "text": "CSS",
                                "action": function(){ 
                                    editor.session.setMode("ace/mode/css");
                                },
                            }, //CSS
                            { 
                                "text": "Text",
                                "action": function(){ 
                                    editor.session.setMode("ace/mode/text");
                                },
                            } //Text
                        ]
                    }, //Syntax mode
                ]
                var viewMenu = [
                    { 
                        "text": "Print margin",
                        "action": function(){ 
                            if(editor.getShowPrintMargin()){ 
                                editor.setShowPrintMargin(false);
                            }
                            else{ 
                                editor.setShowPrintMargin(true);
                            }
                        }
                    }, //Print margin
                    { 
                        "text": "Toggle font size",
                        "action": function(){ 
                            if(editor.getFontSize() == 12){ 
                                editor.setFontSize(15)
                            }
                            else{ 
                                editor.setFontSize(12)
                            }
                        }
                    }, //Toggle font size
                    { 
                        "text": "Theme",
                        "sub":[
                            { 
                                "text": "ambiance",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/ambiance");
                                }
                            }, //ambiance
                            { 
                                "text": "chaos",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/chaos");
                                }
                            }, //chaos
                            { 
                                "text": "chrome",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/chrome");
                                }
                            }, //chrome
                            { 
                                "text": "clouds",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/clouds");
                                }
                            }, //clouds
                            { 
                                "text": "clouds_midnight",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/clouds_midnight");
                                }
                            }, //clouds_midnight
                            { 
                                "text": "cobalt",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/cobalt");
                                }
                            }, //cobalt
                            { 
                                "text": "crimson_editor",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/crimson_editor");
                                }
                            }, //crimson_editor
                            { 
                                "text": "dawn",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/dawn");
                                }
                            }, //dawn
                            { 
                                "text": "dracula",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/dracula");
                                }
                            }, //dracula
                            { 
                                "text": "dreamweaver",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/dreamweaver");
                                }
                            }, //dreamweaver
                            { 
                                "text": "eclipse",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/eclipse");
                                }
                            }, //eclipse
                            { 
                                "text": "github",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/github");
                                }
                            }, //github
                            { 
                                "text": "gob",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/gob");
                                }
                            }, //gob
                            { 
                                "text": "gruvbox",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/gruvbox");
                                }
                            }, //gruvbox
                            { 
                                "text": "idle_fingers",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/idle_fingers");
                                }
                            }, //idle_fingers
                            { 
                                "text": "iplastic",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/iplastic");
                                }
                            }, //iplastic
                            { 
                                "text": "katzenmilch",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/katzenmilch");
                                }
                            }, //katzenmilch
                            { 
                                "text": "kr_theme",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/kr_theme");
                                }
                            }, //kr_theme
                            { 
                                "text": "kuroir",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/kuroir");
                                }
                            }, //kuroir
                            { 
                                "text": "merbivore",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/merbivore");
                                }
                            }, //merbivore
                            { 
                                "text": "merbivore_soft",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/merbivore_soft");
                                }
                            }, //merbivore_soft
                            { 
                                "text": "mono_industrial",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/mono_industrial");
                                }
                            }, //mono_industrial
                            { 
                                "text": "monokai",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/monokai");
                                }
                            }, //monokai
                            { 
                                "text": "nord_dark",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/nord_dark");
                                }
                            }, //nord_dark
                            { 
                                "text": "one_dark",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/one_dark");
                                }
                            }, //one_dark
                            { 
                                "text": "pastel_on_dark",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/pastel_on_dark");
                                }
                            }, //pastel_on_dark
                            { 
                                "text": "solarized_dark",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/solarized_dark");
                                }
                            }, //solarized_dark
                            { 
                                "text": "solarized_light",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/solarized_light");
                                }
                            }, //solarized_light
                            { 
                                "text": "sqlserver",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/sqlserver");
                                }
                            }, //sqlserver
                            { 
                                "text": "terminal",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/terminal");
                                }
                            }, //terminal
                            { 
                                "text": "textmate",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/textmate");
                                }
                            }, //textmate
                            { 
                                "text": "tomorrow",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/tomorrow");
                                }
                            }, //tomorrow
                            { 
                                "text": "tomorrow_night",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/tomorrow_night");
                                }
                            }, //tomorrow_night
                            { 
                                "text": "tomorrow_night_blue",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/tomorrow_night_blue");
                                }
                            }, //tomorrow_night_blue
                            { 
                                "text": "tomorrow_night_bright",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/tomorrow_night_bright");
                                }
                            }, //tomorrow_night_bright
                            { 
                                "text": "tomorrow_night_eighties",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/tomorrow_night_eighties");
                                }
                            }, //tomorrow_night_eighties
                            { 
                                "text": "twilight",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/twilight");
                                }
                            }, //twilight
                            { 
                                "text": "vibrant_ink",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/vibrant_ink");
                                }
                            }, //vibrant_ink
                            { 
                                "text": "xcode",
                                "action": function(){ 
                                    editor.setTheme("ace/theme/xcode");
                                }
                            }, //xcode
                        ],
                    }, //Theme
                ]
                var aceeditorMenu = [
                    { 
                        "text": "Save and run",
                        "action": function(){ 
                            if(savedDir !== undefined){ 
                                saveFile(savedDir, getACEVal(), function(){ 
                                    openFile(savedDir)
                                })
                                
                            }
                            else{ 
                                saveAsFile('ACEeditor file.txt', getACEVal(), function(path){ 
                                    savedDir = path
                                    openFile(path)
                                })
                            }
                        }
                    }
                ]
                var funcMenu = [
                    { 
                        "text": "Help",
                        // "action": function(){ 
                        //     openFile(filePath('./help.html'))
                        // }
                        "divider": true,
                    }, //Help
                    { 
                        "text": "OS functions",
                        "sub": [
                            { 
                        "text": "filePath{ }",
                        "sub":[
                            { 
                                "text": "filePath.path()"
                            }, //path()
                            { 
                                "text": "filePath.wholePath()"
                            }, //wholePath()
                            { 
                                "text": "filePath.name()"
                            }, //name()
                            { 
                                "text": "filePath.formattedName()"
                            }, //formattedName()
                            { 
                                "text": "filePath.type()"
                            }, //type()
                            { 
                                "text": "filePath.alldata()"
                            }, //alldate()
                            { 
                                "text": "filePath.data()"
                            }, //data()
                            { 
                                "text": "filePath.date()"
                            }, //date()
                            { 
                                "text": "filePath.folder()"
                            }, //folder()
                            { 
                                "text": "filePath.all()"
                            }, //all()
                        ],
                    }, //filePath{ }
                            { 
                                "text": "openFile()",
                            }, //openFile()
                            { 
                                "text": "fileIcon()",
                            }, //fileIcon()
                            { 
                                "text": "saveFile()",
                            }, //saveFile()
                            { 
                                "text": "saveAsFile()",
                            }, //saveAsFile()
                            { 
                                "text": "deleteFile()",
                            }, //deleteFile()
                            { 
                                "text": "createFile()",
                            }, //createFile()
                            { 
                                "text": "renameFile()",
                            }, //renameFile()
                            { 
                                "text": "loadCSS()",
                            }, //loadCSS()
                            { 
                                "text": "saveOS()",
                            }, //saveOS()
                            { 
                                "text": "loadSavedOS()",
                            }, //loadSavedOS()
                            { 
                                "text": "reinstallOS()",
                            }, //reinstallOS()
                        ]
                    }, //OS functions
                    { 
                        "text": "Extra functions",
                        "sub": [
                            { 
                                "text": "String.replaceAt()"
                            }, //String.replaceAt()
                            { 
                                "text": "destroyed Event"
                            }, //destroyed Event
                            { 
                                "text": "deepClone()"
                            }, //deepClone
                            { 
                                "text": "lightOrDark()"
                            }, //lightOrDark()
                            { 
                                "text": "whiteOrBlack()"
                            }, //whiteOrBlack()
                            { 
                                "text": "hexToRgb()"
                            }, //hexToRgb
                            { 
                                "text": "consoleMessage()"
                            }, //consoleMessage()
                            { 
                                "text": "dateString()",
                            }, //dateString()
                            { 
                                "text" : "contextMenu()",
                            }, //contextMenu()
                            { 
                                "text": "jQuery.tooltip()",
                            }, //jQuery.tooltip()
                        ]
                    }, //Extra functions
                ]
                
                contextMenu('click', fileMenu, n + " .ACEeditor-button-file")
                contextMenu('click', formatMenu, n + " .ACEeditor-button-format")
                contextMenu('click', viewMenu, n + " .ACEeditor-button-view")
                contextMenu('click', aceeditorMenu, n + " .ACEeditor-button-aceeditor")
                contextMenu('contextMenu', funcMenu, n + ' .ace_text-input')
                
            }, [28, 3, 2021]],
            
            HTMLviewer : [
                function() { 
                
                    loadCSS(filePath.wholePath('./HTMLviewer_style.css'))
                
                    applicationHolder({ 
                        'background-color': 'rgb(247, 247, 247)'
                    }, directory)
                    
                    var n = '#application-' + (openedScreens - 1)
                    var a = n + ' > .app'
                    
                    var savedCont = openedFileContext || ""
                    
                    openedFileContext = undefined
                
                    $(a).append('<iframe class="HTMLviewer-iframe"></iframe>')
                
                    var iframe = $(n + ' .HTMLviewer-iframe')[0],
                        iframeWin = iframe.contentWindow || iframe,
                        iframeDoc = iframe.contentDocument || iframeWin.document;
                    
                    
                    iframeDoc.open();
                    iframeDoc.write(filePath.data(savedCont));
                    iframeDoc.close();
                    
                },
                [2, 4, 2021]
            ],
            
            KAprojects : [
                function() { 

    applicationHolder({ 
        'background-color': 'rgb(255,255,255)',
        'width': '400px',
        'height': '400px'
    }, directory);
    var n = '#application-' + (openedScreens - 1);
    var a = n + ' > .app';
    var f = openedFileContext || ''
    var cont = filePath.type(f) === 'kap' ? filePath.data(f) : "4854494034345984"
    openedFileContext = ''
    
    $.getJSON('https://www.khanacademy.org/api/internal/scratchpads/' + cont + '?callback=?', function(d){ 
        
        if(d.userAuthoredContentType === 'webpage'){ 
            $(a).append('<iframe></iframe>')
            var ifr = $('iframe', a).first()
            ifr.css({ 
                'border': 'none',
                'position': 'absolute',
                'height': '100%',
                'width': '100%'
            })
        
            var iframe = ifr[0],
                iframeWin = iframe.contentWindow || iframe,
                iframeDoc = iframe.contentDocument || iframeWin.document;
            
            
            iframeDoc.open();
            iframeDoc.write(d.revision.code);
            iframeDoc.close();
        }
        else{ 
            openFile('C:/Windows/Base/Popup/Popup.exe', [
                        'C:/Windows/Base/Popup/context.dat',
                        'KA Projects does not open this type of project (' + d.userAuthoredContentType + ')',
                        'error',
                    ]);
            
        }
    })

},
                [22, 4, 2021]
            ],
          
            webBrowser: [
                function() {
                  loadCSS(filePath.wholePath('./webBrowser_style.css'))

                  applicationHolder({ 
                    'background-color': 'rgb(200,200,200)'
                  }, directory)

                  var n = '#application-' + (openedScreens - 1)
                  var a = n + ' > .app'

                  var savedCont = openedFileContext || ""

                  openedFileContext = undefined

                  $(a).append(`<div class="webBrowser">
  <div class="input-area">
    <div class="back">
      <svg width="10" height="10">
        <line x1="0" y1="5" x2="10" y2="5" style="stroke:black;stroke-width:2;" />
        <line x1="3" y1="2" x2="0" y2="5" style="stroke:black;stroke-width:2;" />
        <line x1="3" y1="8" x2="0" y2="5" style="stroke:black;stroke-width:2;" />
      </svg>
    </div>
    <div class="forward">
      <svg width="10" height="10">
        <line x1="0" y1="5" x2="10" y2="5" style="stroke:black;stroke-width:2;" />
        <line x1="7" y1="2" x2="10" y2="5" style="stroke:black;stroke-width:2;" />
        <line x1="7" y1="8" x2="10" y2="5" style="stroke:black;stroke-width:2;" />
      </svg>
    </div>
    <input placeholder="URL">
  </div>
  <iframe src="https://google.com"></iframe>
</div>`)
                
                  var iframe = document.querySelector(n + ' .webBrowser iframe'),
                      iframeWin = iframe.contentWindow || iframe,
                      iframeDoc = iframe.contentDocument || iframeWin.document,
                      input = document.querySelector(n+" .webBrowser .input-area input")
                  var prefixs = ["https://", "http://", "file://", "about:"];
                  var browserHistory = ["https://google.com"],
                      historyIdx = 0
                  function goTo(url){
                    iframe.src = this.value;

                    browserHistory.splice(historyIdx+1, browserHistory.length - historyIdx);
                  }
                  function updateUrlToHistory(){
                    var iframeURL = browserHistory[historyIdx];
                    input.value = iframeURL;

                    browserHistory.push(iframeURL);
                    historyIdx = browserHistory.length - 1;
                    
                    iframe.src = iframeURL
                    input.value = iframe.src;
                  }
                  input.onkeyup = function(e){
                    if(e.key === "Enter"){
                      var hasPrefix = false;
                      for(var i=0; i<prefixs.length; i++){
                        if(this.value.indexOf(prefixs[i]) === 0){
                          hasPrefix = true;
                        }
                      }
                      if(!hasPrefix) this.value = "https://" + this.value;
                      iframe.src = this.value;
                      this.value = iframe.src;
                      this.blur();

                      browserHistory.splice(historyIdx+1, browserHistory.length - historyIdx);
                    }
                  }
                  document.querySelector(".webBrowser .back").onclick = function(){
                    historyIdx --;
                    if(historyIdx < 0){
                      historyIdx = 0;
                    }
                    updateUrlToHistory()
                  }
                  document.querySelector(".webBrowser .forward").onclick = function(){
                    historyIdx ++;
                    if(historyIdx >= browserHistory.length){
                      historyIdx = browserHistory.length-1;
                    }
                    updateUrlToHistory()
                  }


                  /*iframeDoc.open();
                  iframeDoc.write(filePath.data(savedCont));
                  iframeDoc.close();*/
                },
                [22, 6, 2021]
            ],
            
            startup : [function(){ 
                
                //this file takes care of startup it CANNOT be changed by the program
                
                function bootMessage(txt, css){ 
                    $('.loadingOS').append('<br><span style="' + css + '">' + txt + '</span>')
                    // consoleMessage(txt, 'system')
                }
                
                
                bootMessage('â–ˆâ–ˆ     â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ     â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ')
                bootMessage('â–ˆâ–ˆ     â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆ     â–ˆâ–ˆ â–ˆâ–ˆ          â–ˆâ–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ ')
                bootMessage('â–ˆâ–ˆ  â–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆ  â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ ')
                bootMessage('â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆ      â–ˆâ–ˆ      â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ ')
                bootMessage(' â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (2021)')
                bootMessage('- By H 2 O ')
                bootMessage('')
                bootMessage('Booting...')
                
                bootMessage('Loading Scripts')
                
                var continueBoot = true
                var bootWithLS = true
                
                $('.loadingOS').click(function(){ 
                    continueBoot = false
                })
                
                function boot(){ 
                    $.when(
                    $.getScript('https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js'),
                    $.getScript('https://cdn.rawgit.com/beautify-web/js-beautify/v1.13.6/js/lib/beautify.js'),
                    $.getScript('https://cdn.rawgit.com/beautify-web/js-beautify/v1.13.6/js/lib/beautify-css.js'),
                    $.getScript('https://cdn.rawgit.com/beautify-web/js-beautify/v1.13.6/js/lib/beautify-html.js'),
                    $.getScript('https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js')
                    // $.getScript('https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js')
                ).done(function(){ 
                    bootMessage('Scripts Loaded')
                    
                    
                    setTimeout(function(){ 
                        
                        if(continueBoot){ 
                            
                            if(bootWithLS){ 
                                bootMessage('Loading saved OS')
                                loadSavedOS()
                            }
                            else{ 
                                bootMessage('Starting in Safe Mode')
                            }
                            
                            bootMessage('Starting up taskbar and desktop')
                            startupTaskbar()
                            startupDesktop()
                            
                            bootMessage('Preparing SVG defs')
                            filePath.data('C:/Windows/Source/Prepare_SVG_defs.dat').forEach(function(w){ 
                                $('body').prepend('<svg style="position: absolute; left: -200px; width:1px; height:1px;">' + w + '</svg>')
                            })
                            
                            setTimeout(function(){ 
                                $('.loadingOS').hide()
                            }, 500)
                        }
                        else{ 
                        $('.loadingOS').empty()
                        bootMessage('â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—')
                        bootMessage('â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•')
                        bootMessage('â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—')
                        bootMessage('â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘')
                        bootMessage('â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘')
                        bootMessage('â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•')
                        bootMessage('')
                        bootMessage('* Windows 10 Simulator by H 2 O')
                        bootMessage('')
                        bootMessage('')
                        bootMessage('You see this screen becasue you interrupted\nthe boot sequence or something went wrong\nduring scripts execution.')
                        bootMessage('')
                        bootMessage('')
                        bootMessage('> Safe Mode [S]', 'font-weight:bold; background-color:rgba(255, 255, 255, 0.3);')
                        bootMessage('(Does not load localStorage, but doesnt clear it)')
                        bootMessage('')
                        bootMessage('> Reinstall Windows [R]', 'font-weight:bold; background-color:rgba(255, 255, 255, 0.3);')
                        bootMessage('Clears localStorage')
                        bootMessage('')
                        bootMessage('> Start Windows Normally [ENTER]', 'font-weight:bold; background-color:rgba(255, 255, 255, 0.3);')
                        
                        $(document).keypress(function(e){ 
                            var keyCode = e.keyCode || e.which;
                            
                            if(keyCode == 13){ //Enter
                                $('.loadingOS').empty()
                                continueBoot = true
                                boot()
                                $(document).unbind('keypress')
                            }
                            else if(keyCode == 114){ //R
                                $('.loadingOS').empty()
                                reinstallOS()
                                continueBoot = true
                                boot()
                                $(document).unbind('keypress')
                            }
                            else if(keyCode == 115){ //S
                                $('.loadingOS').empty()
                                bootWithLS = false
                                continueBoot = true
                                boot()
                                $(document).unbind('keypress')
                            }
                            
                            
                        })
                        
                    }
                    
                    }, 300)
                })
                
                }
                
                boot()
                
                
            }],
            
        }
        
        
        var jsFile = { 
            treeview:["function treeview(o, con){ \
                        if(typeof o !== 'object'){ \
                            consoleMessage('Not object! (treeView)', 'error');\
                            return;\
                        }//it2akad enno object\n\
                        for(e in o){ \
                            if(e.match(/[.]/g)==null){ //it2akad enno mish file\n\
                                var li = $('<li></li>');\
                                li.text(e);\
                                li.attr('dir_name', e);\
                                \
                                var ol = $('<ol></ol>');\
                                li.append(ol);\
                                \
                                treeview(o[e], ol);\
                                con.append(li);\
                            }\
                        }\
                    }"]
        }
        
        
        var cssFile = { 
            fileexplorer:[
                '.files-wrapper{ \n width:100%; \n height:100%; \n display:flex; \n flex-direction:column; \n } \n .files-top-directory{ \n height:25px; \n border-top:1px solid rgba(0,0,0,0.1); \n display:flex; \n } \n .files-top-directory-back:hover{ \n background-color:rgba(0,0,0,0.05); \n cursor:pointer; \n } \n .files-top-directory-back:active{ \n background-color:rgba(0,0,0,0.1); \n } \n .files-top-directory-path{ \n font-size:13px; \n margin: 0 5px; \n display: flex; \n align-items: center; \n white-space: nowrap; \n text-overflow: ellipsis; \n overflow:hidden; \n } \n .files-top-directory-refresh{ \n margin-left:auto; \n width:30px; \n padding:3px 0; \n display:flex; \n justify-content:center; \n } \n .files-top-directory-refresh:hover{ \n background-color:rgba(0,0,0,0.05); \n cursor:pointer; \n } \n .files-top-directory-refresh:active{ \n background-color:rgba(0,0,0,0.1); \n } \n .files-top-directory-refresh svg{ \n width:auto; \n height:100%; \n } \n .files-top{ \n width:100%; \n height:calc(100% - 35px - 25px); \n background-color:white; \n display:flex; \n border-top:1px solid rgb(0,0,0,0.1); \n } \n .files-top-struc{ \n width:50%; \n max-width:300px; \n overflow-y:scroll; \n background-color:#FFF; \n font-size:13px; \n } \n .files-top-struc-ol{ \n padding:0px; \n padding-left:10px \n } \n .files-top-struc-ol ol { \n margin-left: 8px; \n padding-left: 7px; \n border-left: 1px dashed rgb(0, 0, 0, 0.2); \n } \n .files-top-struc-ol li { \n margin-top:5px; \n list-style: none; \n color: rgb(31, 31, 31); \n font-size: 12px; \n font-weight: normal; \n white-space: nowrap; \n } \n .files-top-struc-ol svg { \n vertical-align:sub; \n width:20px; \n } \n .files-top-struc-ol a { \n color:inherit; \n text-decoration:none; \n } \n .files-top-struc-ol a:hover{ \n background-color:rgba(0, 0, 0,0.05); \n border:1px solid rgba(0,0,0,0.03); \n } \n .files-top-struc-ol div:hover{ \n padding:none; \n background-color:rgba(0, 225, 255, 0.06); \n } \n .files-top-cont{ \n width:100%; \n padding-top:5px; \n overflow-y:scroll; \n display:flex; \n flex-direction:column; \n } \n .files-top-cont-files{ \n font-size:12px; \n } \n .files-top-cont-emptyspace{ \n min-height:80px; \n height:100%; \n } \n .files-cont-item{ \n font-size:inherit; \n padding:1px; \n display:flex; \n } \n .files-cont-item:hover:not(.files-selected){ \n padding:0; \n background-color:rgba(0, 225, 255, 0.06); \n border:1px solid rgb(0, 255, 255, 0.08); \n } \n .files-cont-item-svg{ \n width:20px; \n margin: 0 2px 0 2px; \n } \n .files-cont-item svg{ \n vertical-align:sub; \n } \n .files-cont-item-values{ \n white-space: nowrap; \n overflow:hidden; \n text-overflow:ellipsis; \n width:100%; \n } \n .files-top-cont-files-empty{ \n text-align:center; \n font-size:inherit; \n } \n .files-bottom{ \n width:100%; \n height:100%; \n max-height:45px; \n background-color:white; \n border-top:1px solid rgba(0,0,0,0.15); \n display:flex; \n } \n .files-bottom-svg{ \n display: flex; \n align-items: center; \n margin: 0 5px; \n } \n .files-bottom-svg svg{ \n margin: 0 auto; \n height:100%; \n display:block; \n } \n .files-bottom-name{ \n display: flex; \n align-items: center; \n margin-left:5px; \n font-size:14px; \n white-space: nowrap; \n overflow: hidden; \n } \n .files-bottom-data{ \n display: flex; \n align-items: center; \n margin-left:5px; \n font-size:14px; \n white-space: nowrap; \n overflow: hidden; \n } \n .files-selected{ \n padding:0; \n background-color:rgba(0, 187, 255, 0.15); \n border:1px solid rgb(0, 187, 255, 0.25); \n }',
                [31, 3, 2021]],
            photos:[
            '.photo-top{ \n width:100%; \n height:25px; \n background-color:black; \n display:flex; \n } \n .photo-top-date{ \n color:white; \n font-family:inherit; \n font-size:11px; \n margin-left:5px; \n width:30%; \n white-space: nowrap; \n text-overflow: ellipsis; \n overflow:hidden; \n } \n .photo-top-trash{ \n width:20px; \n height:100%; \n margin-left: auto; \n } \n .photo-main{ \n width:100%; \n height:calc(100% - 25px); \n background-color:black; \n } \n .photo-main-photo{ \n height:auto; \n width:auto; \n max-height:100%; \n max-width:100%; \n display:block; \n margin:auto; \n pointer-events:none; \n } \n .photo-main-left{ \n position:absolute; \n left:0; \n top:50%; \n width:25px; \n height:25px; \n background-color:rgba(0,0,0, 0.2); \n } \n .photo-main-right{ \n position:absolute; \n right:0; \n top:50%; \n width:25px; \n height:25px; \n background-color:rgba(0,0,0, 0.2); \n }',
            [31, 3, 2021]
            ],
            notepad:[
                '.notepad-wrapper{ \n display:flex; \n flex-direction:column; \n height:100%; \n } \n  \n .notepad-top{ \n background-color:white; \n height:15px; \n display:flex; \n } \n .notepad-top-button{ \n font-size:70%; \n padding:0 5px; \n display:flex; \n align-items:center \n } \n .notepad-top-button:hover{ \n background-color:rgba(0,0,0,0.1); \n } \n  \n .notepad-bottom{ \n background-color:white; \n height:100%; \n } \n .notepad-bottom-main{ \n overflow-y:scroll; \n height:100%; \n width:100%; \n resize:none; \n border:1px solid rgba(0,0,0,0.1); \n outline:0; \n font-family:monospace inherit; \n } \n  \n .notepad-wordwrap{ \n white-space:nowrap; \n } \n  \n .notepad-bottom-main[styleD="default"]{ \n background-color:white; \n color:black; \n } \n .notepad-bottom-main[styleD="default"]::selection{ \n background-color:#3297FD; \n color:white; \n } \n  \n .notepad-bottom-main[styleD="invert"]{ \n background-color:rgb(0, 0, 0); \n color:white; \n } \n .notepad-bottom-main[styleD="invert"]::selection{ \n background: rgba(255, 255, 255, 0.5); \n color:white; \n } \n  \n .notepad-bottom-main[styleD="gradient"]{ \n  \n background: linear-gradient(315deg, #e700ff, #6b00ff, #ff2f00); \n background-size: 800% 800%; \n  \n animation: GradientAnimation 10s ease infinite; \n  \n color:white; \n font-weight:bolder; \n font-size: inherit; \n text-shadow:0px 0px 10px white; \n box-shadow:0 0 10px black; \n } \n .notepad-bottom-main[styleD="gradient"]::selection{ \n background: rgba(255, 255, 255, 0.5); \n color:white; \n font-size:20px; \n font-weight:5000; \n text-shadow:3px 3px yellow; \n -webkit-text-stroke:1px rgb(151, 219, 151); \n } \n  \n .notepad-bottom-main[styleD="hacker"]{ \n background-color:rgb(0, 0, 0); \n color:rgb(0, 255, 0); \n font-weight:900; \n text-shadow:0 0 4px white; \n } \n .notepad-bottom-main[styleD="hacker"]::selection{ \n background: yellow; \n color:black; \n } \n  \n @keyframes GradientAnimation { \n 50%{ background-position:100% 100%;} \n 40%{ transform: rotate3d(1, 1, 1, 1440deg);} \n 1%{ font-size:20px; color:black;} \n } \n ',
                [31, 3, 2021]
            ],
            popup:[
                '.popup-wrapper{ \n display:flex; \n flex-direction: column; \n width:100%; \n height:100% \n } \n .popup-content{ \n display:flex; \n width:100%; \n height:90%; \n overflow:hidden; \n } \n .popup-content-image{ \n width:30%; \n min-width:100px; \n } \n .popup-content-image-svg{ \n margin-left:5px; \n height:100%; \n max-width:90px; \n } \n .popup-content-text{ \n font-size:13.5px; \n width:50%; \n overflow-x:auto; \n margin:auto 0 auto 10px; \n } \n  \n .popup-bottom{ \n width:100%; \n background-color:rgb(230, 230, 230); \n display:flex; \n } \n .popup-bottom-button{ \n margin: 5px; \n width:25%; \n max-width:100px; \n text-align:center; \n font-size:14px; \n border:1px solid rgb(0,0,0,0.07); \n background-color:rgba(0,0,0,0.05); \n padding:1px; /* So that border doesnt increase height  */ \n } \n .popup-bottom-button:active{ \n border:2px solid rgb(0, 129, 176); \n padding:0px; \n }',
                [31, 3, 2021]
            ],
            subPopup:[
                '.subPopup-wrapper{ \n height:100%; \n display:flex; \n flex-direction:column; \n } \n  \n .subPopup-input-title{ \n width:100%; \n padding:3px 0 0 5px; \n overflow:hidden; \n white-space:nowrap; \n text-overflow:ellipsis; \n font-size:14px; \n } \n .subPopup-input-field{ \n height:30px; \n display:inline-block; \n margin:5px; \n } \n .subPopup-input-input{ \n width:100%; \n height:100%; \n border-radius:0; \n outline:0; \n border:1px solid rgb(0,0,0,0.1); \n } \n .subPopup-input-input:focus{ \n box-shadow: 0 0 10px rgb(0,0,0,0.2); \n } \n  \n .subPopup-input-bottom{ \n width:100%; \n display:flex; \n justify-content:space-between; \n margin:5px 0; \n padding:0 15%; \n } \n .subPopup-button{ \n text-align:center; \n font-size:14px; \n border:1px solid rgb(0,0,0,0.07); \n background-color:rgba(0,0,0,0.05); \n padding:1px 10px; /* So that border doesnt increase height  */ \n } \n .subPopup-button:active{ \n border:2px solid rgb(0, 129, 176); \n padding:0px 9px; \n }',
                [31, 3, 2021]
            ],
            ACEeditor:[
                '.ACEeditor-wrapper{ \n width:100%; \n height:100%; \n display:flex; \n flex-direction:column; \n } \n .ACEeditor-top{ \n display:flex; \n height:15px; \n overflow:hidden; \n } \n .ACEeditor-top-button{ \n font-size:70%; \n padding:0 5px; \n display:flex; \n align-items:center \n } \n .ACEeditor-top-button:hover{ \n background-color:rgba(0,0,0,0.1); \n } \n  \n .ACEeditor-bottom{ \n position:relative; \n height:100%; \n width:100%; \n } \n .ACEeditor-editor{ \n position:absolute; \n top: 0px; \n right: 0; \n bottom: 0; \n left: 0; \n } \n .ACEeditor-editor ::-webkit-scrollbar{ \n width:10px; \n height:10px; \n } \n  \n .ACEeditor-editor ::-webkit-scrollbar-track { \n box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.5); \n background-color:rgba(100,100,100, 0.3); \n } \n  \n .ACEeditor-editor ::-webkit-scrollbar-thumb { \n background-color: rgb(130, 130, 130); \n border-radius:3px; \n } \n  \n .ACEeditor-editor ::-webkit-scrollbar-corner{ \n background-color:rgb(0,0,0,0); \n width:0; \n height:0; \n }',
                [31, 3, 2021]
            ],
            HTMLviewer: [
                '.HTMLviewer-iframe{ position: absolute;left:0;top:0;width:100%;height:100%;border:none;margin:0;padding:0;}',
                [2, 4, 2021]
            ],
            webBrowser: [
              `.webBrowser{
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
}
.webBrowser iframe{
  width:100%;
  height:100%;
  background:white;
  border:none;
}
.webBrowser .input-area{
  border-bottom:1px solid gray;
  background:#ccc;
  padding:10px;
  display:flex;
  flex-direction:row;
}
.webBrowser .back, .webBrowser .forward{
  padding:5px;
  border-radius:100%;
}
.webBrowser .back:hover, .webBrowser .forward:hover{
  background:#aaa;
}
.webBrowser input{
  width:100%;
  background:100%;
  border-radius:5px;
  padding:4px;
  background:white;
  border:none;
  outline:none;
  font-size:16px;
}
.webBrowser input:focus{
  outline:1px solid #0af;
}`,
              [22, 6, 2021]
            ]
        }
        
        
        var textFile = { 
            '1': ['test 123',],
            A_readMe: ['Driver A: contains stuff that has to do with localStorage, currently empty'],
            filesNote: ['File Explorer works properly\n\nfile properties window and the send to is still not made tho', [26, 3, 2021]],
            taskbarNote:['Taskbar is not 100% complete but im too lazy to fix it',[4, 4, 2021]],
            KAprojectsNote: ['KAprojects only opens Webpage projects, .kap files are text-based files that contain the project url ID of the project you wish to open'],
            Note_About_Project: ['I will be creating a newer and better version off khanacademy, the saved filesystem data is saved in localStorage, if you keep clicking the screen when booting you can open BIOS where you can clear your localStorage.\n\nAlso dont forget you can right click on stuff :)\n\nNote that opening this project in Full Screen is completely safe.\n\nAnd for anyone curious about how this works, you can right click on any file and open in Ace Editor to see what code is inside them, you can also right click inside the Ace Editor to see all functions related to managing and handling the filesystem, go to C:/Windows/Source to see how the OS determines how to open a file.\nAfter i made Ace Editor, all the apps were created from inside the OS itself, HTMLviewer and KA projects were created from inside the program, the Ace Editor is 10x better than the khanacademy editor.', [20, 6, 2021]]
        }
        
        
        var dataFile = { 
            
            
                popup : [['Error', 'error']],   //Error.exe
                subPopup : [['Hello', 'input']],
                fileexplorer : [['C:/Users']],
                
                
                //SOURCE
                defaultPrograms : [{ 
                    
                    'jpg' : 'C:/Program_Files/Photos/Photos.exe',
                        
                    'png' : 'C:/Program_Files/Photos/Photos.exe',
                        
                    'txt' : 'C:/Program_Files/Notepad/Notepad.exe',
                    
                    'html': 'C:/Program_Files/HTMLviewer/HTMLviewer.exe',
                    
                    'svg': 'C:/Program_Files/HTMLviewer/HTMLviewer.exe',
                    
                    'js': 'C:/Program_Files/ACEeditor/ACEeditor.exe',
                    
                    'css': 'C:/Program_Files/ACEeditor/ACEeditor.exe',
                    
                    'kap': 'C:/Program_Files/KA Projects/KA Projects.exe',
                    
                    'File folder' : 'C:/Windows/Main/File_Explorer/Files.exe'
                    
                }],
                    
                filetypePrograms : [{ 
                        
                    'jpg' : ['C:/Program_Files/Photos/Photos.exe'],
                        
                    'png' : ['C:/Program_Files/Photos/Photos.exe'],
                        
                    'gif' : ['C:/Program_Files/Photos/Photos.exe'],
                        
                    'txt' : ['C:/Program_Files/Notepad/Notepad.exe'],
                    
                    'js': ['C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'html': ['C:/Program_Files/HTMLviewer/HTMLviewer.exe', 'C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'css': ['C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'kap': ['C:/Program_Files/KA Projects/KA Projects.exe'],
                    
                    'File folder' : ['C:/Windows/Main/File_Explorer/Files.exe']
                    
                }],
                
                datatypePrograms : [{ 
                    
                    'string': ['C:/Program_Files/Notepad/Notepad.exe', 'C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'function': ['C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'number': ['C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'bigint': ['C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'boolean': ['C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'symbol': ['C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    
                    'object': ['C:/Program_Files/ACEeditor/ACEeditor.exe'],
                    //symbol : no symbol cuz unique or maybe it will work idk
                }],
                
                SVGdefs : [[
                    '<defs> <linearGradient id="photoIconGrad" x1="30%" y1="30%" x2="100%" y2="100%"> <stop offset="0%" style="stop-color:rgb(40,175,234);stop-opacity:1" /> <stop offset="100%" style="stop-color:rgb(194,131,223);stop-opacity:1" /> </linearGradient> </defs>',
                    '<defs> <linearGradient id="Gradient_1" gradientUnits="userSpaceOnUse" x1="-97.0875" y1="-102.95" x2="96.48750000000001" y2="-102.95" spreadMethod="pad"> <stop offset="0%" stop-color="#FFE897"/> <stop offset="100%" stop-color="#FBDA62"/> </linearGradient> <linearGradient id="Gradient_2" gradientUnits="userSpaceOnUse" x1="-97.075" y1="3.45" x2="97.075" y2="3.45" spreadMethod="pad"> <stop offset="0%" stop-color="#FFE897"/> <stop offset="100%" stop-color="#FBDA62"/> </linearGradient> </defs>',
                    '<defs>         <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="0%">             <stop offset="0%" style="stop-color:rgb(235,198,94); stop-opacity:1" />     <stop offset="100%" style="stop-color:rgb(253, 226, 133); stop-opacity:1" />         </linearGradient>     </defs>',
                    "<defs><linearGradient id='ace-grad' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' style='stop-color:rgb(92, 85, 235);stop-opacity:1' /><stop offset='100%' style='stop-color:rgb(235, 106, 226);stop-opacity:1' /></linearGradient><linearGradient id='ace-invertgrad' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' style='stop-color:rgb(235, 106, 226);stop-opacity:1' /><stop offset='100%' style='stop-color:rgb(92, 85, 235);stop-opacity:1' /></linearGradient></defs>",
                ], [14, 4, 2021]],
                
        }
        
        
        var imageFile = { 
            "Fox":[
                
                'https://www.kasandbox.org/programming-images/animals/fox.png', 
                
                [27,2,2021]
                
            ],
            "Penguins":[
                
                'https://www.kasandbox.org/programming-images/animals/penguins.png',
                
                [27,2,2021],
                
            ],
            "Birds-Rainbow":[
                
                'https://www.kasandbox.org/programming-images/animals/birds_rainbow-lorakeets.png',
                
                [28,2,2021],
                
            ],
            "Butterfly":[
                
                'https://www.kasandbox.org/programming-images/animals/butterfly.png',
                                
                [28,2,2021],
                
            ],
            "Cat":[
                
                'https://www.kasandbox.org/programming-images/animals/cat.png',
                
                [28,2,2021],
                
            ],
            "Beach":[
                
                'https://www.kasandbox.org/programming-images/landscapes/beach-with-palm-trees.png',
                
                [28,2,2021],
                
            ],
            "Clouds":[
                
                'https://www.kasandbox.org/programming-images/landscapes/clouds-from-plane.png',
                
                [28,2,2021],
                
            ],
            "Lake":[
                    
                    'https://www.kasandbox.org/programming-images/landscapes/lake.png',
                    
                    [28,2,2021],
                    
            ],
            "Lava":[
                    
                    'https://www.kasandbox.org/programming-images/landscapes/lava.png',
                    
                    [28,2,2021],
                    
            ],
            "Mountain":[
                    
                    'https://www.kasandbox.org/programming-images/landscapes/mountain_matterhorn.png',
                    
                    [28,2,2021],
                    
            ],
            "Ugly_horse":[
                    
                    "https://upload.wikimedia.org/wikipedia/commons/e/e3/Animhorse.gif",
                    
                    [21,3,2021],
                    
            ],
            "Wallpaper": [
                'https://www.kasandbox.org/programming-images/animals/fox.png', 
                [5,5,2021]
            ],
        }
        
        
        var htmlFile = { 
            fileProperties:['\
                            <style>\
                            .properties-wrapper{ \
                                width:100%;\
                                height:100%;\
                                display:flex;\
                                felx-direction:column;\
                                background-color:red;\
                            }\
                            </style>\
                            \
                            <div class="properties-wrapper"></div>\
                            ', [28, 3, 2021]],
            HTMLviewer_example:[
                '<!doctype html><html><head><style>body{ background-image:linear-gradient(hotpink, blue);background-repeat: no-repeat;background-attachment: fixed;margin:0;color:white;}</style></head><body><h2>Example HTML file</h2></body></html>',
                [2, 4, 2021]
            ]
        }
        
        
        var FILEDATA = []
        
        
    </script><!--Code-->
    
    <script>
        
        
        var FILESYSTEM = { 
            "C:" : { 
                
                Windows:{ 
                    
                    Main:{ 
                        File_Explorer:{ 
                            "Files.exe": exeFile.fileexplorer,
                            
                            "treeview.js": jsFile.treeview,
                            
                            "files_style.css": cssFile.fileexplorer,
                            
                            "folder_icon.svg" : svgFile.files_folder_icon,
                            "empty_icon.svg" : svgFile.files_empty_icon,
                            "image_icon.svg" : svgFile.files_image_icon,
                            "data_icon.svg" : svgFile.files_data_icon,
                            "exe_icon.svg": svgFile.files_exe_icon,
                            "text_icon.svg": svgFile.files_text_icon,
                            "js_icon.svg": svgFile.files_js_icon,
                            "css_icon.svg": svgFile.files_css_icon,
                            
                            "reload_icon.svg": svgFile.files_reload_icon,
                            "icon.svg" : svgFile.files_icon,
                            
                            'folderLoc.dat' : dataFile.fileexplorer,
                            
                            'fileProperties.html' : htmlFile.fileProperties,
                            
                            'NOTE.txt': textFile.filesNote,
                        },
                    },
                    
                    Base:{ 
                        Popup:{ 
                            'Popup.exe' : exeFile.popup,
                            'popup_style.css': cssFile.popup,
                            'error.svg':svgFile.popup_error_image,
                            'warning.svg':svgFile.popup_warning_image,
                            'context.dat': dataFile.popup,
                        },
                        Sub_Popup:{ 
                            'Sub_Popup.exe' : exeFile.subPopup,
                            'subPopup_style.css': cssFile.subPopup,
                            'context.dat': dataFile.subPopup,
                        },
                        Settings:{
                            "wallpaper.png": imageFile.Wallpaper
                        }
                    },
                    
                    Source:{ 
                        "Javascript_At_Startup.exe": exeFile.startup,
                        
                        "Default_Programs.dat" : dataFile.defaultPrograms,
                        
                        "Filetype_Openers.dat": dataFile.filetypePrograms,
                        
                        "Datatype_Openers.dat": dataFile.datatypePrograms,
                        "Prepare_SVG_defs.dat": dataFile.SVGdefs,
                        "Taskbar note.txt": textFile.taskbarNote,
                        
                    }
                    
                },
                
                Users:{ 
                    Me:{ 
                        
                        Pinned:{ 
                            Taskbar:{ 
                                'Files.lnk':["C:/Windows/Main/File_Explorer/Files.exe", [8, 4, 2021]],
                            }
                        },
                        
                        Desktop:{ 
                            "Files.lnk": ["C:/Windows/Main/File_Explorer/Files.exe", [8, 4, 2021]],
                            "ACEeditor.lnk": ["C:/Program_Files/ACEeditor/ACEeditor.exe", [14, 4, 2021]],
                            "Web-Browser.lnk": ["C:/Program_Files/webBrowser/webBrowser.exe", [22, 6, 2021]]
                        },
                        
                        Downloads:{ 
                            
                        },
                        
                        Favorites:{ 
                            
                        },  
                        
                        Documents:{ 
                            
                        },
                        
                        Music:{ 
                            
                        },
                        
                        Pictures:{ 
                            "Fox.png":imageFile.Fox,
                            "Penguins.png":imageFile.Penguins,
                            "Birds-Rainbow.png":imageFile["Birds-Rainbow"],
                            "Butterfly.png":imageFile.Butterfly,
                            "Cat.png":imageFile.Cat,
                            "Beach.png":imageFile.Beach,
                            "Clouds.png":imageFile.Clouds,
                            "Lake.png":imageFile.Lake,
                            "Lava.png":imageFile.Lava,
                            "Mountain.png":imageFile.Mountain,
                            "Ugly_horse.gif": imageFile.Ugly_horse,
                        },
                        
                        Videos:{ 
                            
                        },
                        
                        
                    },
                    "testing_temp.txt": textFile["1"],
                    "Note About Project.txt": textFile["Note_About_Project"],
                },
                
                Program_Files:{ 
                    
                    Photos:{ 
                        'Photos.exe':exeFile.photos,
                        'photos_style.css':cssFile.photos,
                        'trash-image.svg':svgFile.photos_trash_image,
                        'icon.svg':svgFile.photos_icon,
                    },
                    
                    Notepad:{ 
                        'Notepad.exe':exeFile.notepad,
                        'notepad_style.css':cssFile.notepad,
                        'icon.svg': svgFile.notepad_icon,
                    },
                    
                    ACEeditor:{ 
                        'ACEeditor.exe':exeFile.ACEeditor,
                        'ACEeditor_style.css': cssFile.ACEeditor,
                        'icon.svg': svgFile.ACE_icon,
                    },
                    
                    HTMLviewer:{ 
                        'HTMLviewer.exe': exeFile.HTMLviewer,
                        'HTMLviewer_style.css': cssFile.HTMLviewer,
                        'icon.svg': svgFile.HTMLviewer_icon,
                        'example.html': htmlFile.HTMLviewer_example,
                    },
                    
                    'KA Projects':{ 
                        'KA Projects.exe': exeFile.KAprojects,
                        'IMPORTANT NOTE.txt': textFile.KAprojectsNote,
                        'Projects':{ 
                            'Minekhan.kap': ['5647155001376768', [22, 4, 2021]],
                            'Virtual Machine.kap': ['4854494034345984', [22, 4, 2021]],
                        },
                    },
                    webBrowser:{
                      'webBrowser.exe': exeFile.webBrowser,
                      'webBrowser_style.css': cssFile.webBrowser,
                      'icon.svg': svgFile.webBrowser,
                    }
                },
                
            },
            "A:" : { 
                "README.txt": textFile['A_readMe']
            },
        }
        
        
        var filePath = { 
            
            path: function(path){ 
                
                var a = path
                
                if(path.slice(0, 2) == "./"){ 
                    a = a.split('/')
                    a.splice(0, 1)
                    var d = directory.split('/')
                    d.pop()
                    d = d.concat(a)
                    a = 'FILESYSTEM["' +d.join('"]["') + '"]'
                    
                    p = d.join('/')
                }
                else{ 
                    a = a.split('/')
                    a = a.join('"]["')
                    a = 'FILESYSTEM["' + a + '"]'
                }
                
                return a
                
            },
            
            wholePath: function(path){ 
                var a = path, p = path
                if(path.slice(0, 2) == "./"){ 
                    a = a.split('/')
                    a.splice(0, 1)
                    var d = directory.split('/')
                    d.pop()
                    d = d.concat(a)
                    a = 'FILESYSTEM["' +d.join('"]["') + '"]'
                    
                    p = d.join('/')
                    
                    return p;
                }
                return
            },
            
            name: function(path){ 
                
                n = path.split('/')
                n = n[n.length-1]
                n = n.split('.')[0]
                
                return n
                
            },
            
            formattedName: function(path){ 
                return filePath.name(path).split(' ').join('_')
            },
            
            type: function(path){ 
                var n = path.split('/')
                n = n[n.length-1]
                var t = n.split('.')[1] ? (n.split('.')[n.split('.').length - 1]).toLowerCase() : "File folder"
                
                return t
            },
            
            alldata: function(path){ 
                return eval(filePath.path(path))
            },
            
            data: function(path){ 
                var z = filePath.alldata(path)
                var t = filePath.type(path)
                
                if(z !== undefined){ 
                    var v = t == "File folder" ? z : z[0]
                }
                else{ 
                    var v = undefined
                }
                
                return v
                
            },
            
            date: function(path){ 
                var z = filePath.alldata(path)
                var t = filePath.type(path)
                
                if(z !== undefined){ 
                    var w = t == "File folder" ? undefined : z[1]
                }
                else{ 
                    var w = undefined
                }
                
                return w
                
            },
            
            folder: function(path){ 
                
                var f = path.split('/')
                if(f.length>1){ 
                    f.pop()
                }
                f = f.join('/')
                
                return f
            },
            
            all: function(path){ 
                return { 
                    path : filePath.path(path),
                    wholePath : filePath.wholePath(path),
                    name : filePath.name(path),
                    formattedName : filePath.formattedName(path),
                    type : filePath.type(path),
                    alldata: filePath.alldata(path),
                    data: filePath.data(path),
                    date : filePath.date(path),
                    folder : filePath.folder(path),
                }
            },
        }
        
        
        var directory = '', openedFileContext = '';
        function openFile(fileP, context, openwith){ 
            // lnk = shortcut
            // jpg = image
            
            
            { 
            if(context !== undefined){ 
                
                for(var s in context){ 
                    if(s > 0){ 
                        (filePath.data(context[0]))[s-1] = context[s]
                        // dataFile[context[0]][0][s-1] = context[s]
                    }
                }
                
            }
            }//context dataFile

            
            var a = filePath.type(fileP)
            
            if(a !== "exe" && a !== "lnk"){ 
                
            var defaultProgram = (filePath.data('C:/Windows/Source/Default_Programs.dat'))[a] || (filePath.data('C:/Windows/Source/Filetype_Openers.dat'))[a] || (filePath.data('C:/Windows/Source/Datatype_Openers.dat'))[typeof filePath.data(fileP)]
            
            if(Array.isArray(defaultProgram)){ 
                (filePath.data('C:/Windows/Source/Default_Programs.dat'))[a] = defaultProgram[0]
                defaultProgram = defaultProgram[0]
            }
            
            
            var program = openwith || defaultProgram
            
            }
            
            
            if(program){ 
                    consoleMessage('opening file\n------------------\n' + fileP)
                    
                    openedFileContext = fileP
                    openFile(program)
                    
                    
            }
            else if(a == "exe"){ 
                    consoleMessage('opening Executable file\n------------------\n' + fileP)
                    
                    if(openwith == undefined){ 
                        directory = fileP
                        
                        var b = filePath.data(fileP)
                        try{ b()} catch(e){ openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', 'Unable to open file (' + fileP + '), it seems to not be a function'])}
                    }
                    else{ 
                        openedFileContext = fileP
                        openFile(openwith)
                    }
             
            }
            else if(a == "lnk"){ 
                if(openwith == undefined){ 
                    openFile(filePath.data(fileP))
                }
                else{ 
                    openedFileContext = fileP
                    openFile(openwith)
                }
            }
            else{ 
                
                var d = filePath.data('C:/Windows/Source/Filetype_Openers.dat')
                if(d[a] !== undefined){ 
                    
                    openFile(fileP, [], d[a][0])
                    
                }
                else{ 
                    consoleMessage('Unknown File Format\n------------------\n' + fileP, "error")
                    
                    openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', 'There are no applications that can open ' + a.toUpperCase() + ' files', 'error', null, null])
                }
            }
            
        }
        
        
        function cleanse(str, func){ 
            //https://owasp.org/www-community/xss-filter-evasion-cheatsheet
            
            //prevent xss injection (basically malware (3ashan begdaro ye3'ayro bel localStorage w ye5arbo 3al user)
            
            //too complicated
            
            str = str.replace(/<script/gi, "&lt;script").replace(/script>/gi, "script&gt;");
            
            if(func){ func()}
            
            return str
        }
        
        
        function fileIcon(lnk, func){ 
            
            var type = filePath.type(lnk)
            var icon;
            var fileE = "C:/Windows/Main/File_Explorer"
            if(type == "File folder"){ 
                icon = fileE + "/folder_icon.svg"
            }
            else if(type == "lnk"){ 
                if(filePath.data(lnk) !== undefined){ 
                    return fileIcon(filePath.data(lnk))
                }
                else{ 
                    icon = fileE + "/empty_icon.svg"
                }
            }
            else if(type == "jpg" || type == "png" || type == "gif"){ 
                icon = fileE + "/image_icon.svg"
            }
            else if(type == "exe"){ 
                var folde = filePath.folder(lnk)
                if(filePath.alldata(folde + "/icon.svg") !== undefined){ 
                icon = folde + "/icon.svg"
                }
                else{ 
                    icon = fileE + "/exe_icon.svg"
                }
            }
            else if(type == "dat"){ 
                icon = fileE + "/data_icon.svg"
            }
            else if(type == "txt"){ 
                icon = fileE + "/text_icon.svg"
            }
            else if(type == "js"){ 
                icon = fileE + "/js_icon.svg"
            }
            else if(type == "css"){ 
                icon = fileE + "/css_icon.svg"
            }
            else{ 
                icon = fileE + "/empty_icon.svg"
            }
            
            if(func){ func()}
            
            return cleanse(filePath.data(icon))
        }
        
        
        function saveFile(lnk, dat, func){ 
            
            eval(filePath.path(lnk) + '[0] = dat')
            eval(filePath.path(lnk) + '[1] = getDateArray()')
            
            consoleMessage('Saved Data in ' + lnk)
            saveOS()
            
            if(func){ func()}
            
        }
            
        
        function saveAsFile(name, dat, func){ 
            openFile('C:/Windows/Base/Sub_Popup/Sub_Popup.exe', ['C:/Windows/Base/Sub_Popup/context.dat', 'Save in directory :', 'input',
            null,
            function(a){ 
                createFile(a, name, dat, null)
                openFile(a)
                func(a + '/' + name)
            }])
        }
        
        
        function deleteFile(lnk, func){ 
            eval("delete " + filePath.path(lnk))
            
            saveOS()
            
            if(func){ func()}
        }
        
        
        function nameFile(fol, name, func){ 
            
            if(name.match(/[/\\:*?"<>|]/g)){ 
                openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', "A file name can't contain any of the following characters: <br> \\ / : * ? &ldquo; < > |", 'error'])
                return;
            }
            
            var obj = filePath.data(fol)
            var copies = 0
            var n = name
            var type = filePath.type(name)
            while(obj[n] !== undefined){ 
                copies ++
                
                if(type == "File folder"){ 
                    n = filePath.name(name) + " (" + copies + ")"
                }
                else{ 
                    n = filePath.name(name) + " (" + copies + ")." + type
                }
            }
            
            if(func){ func()}
            
            return n
        }
        
        
        function createFile(lnk, name, value, alldata, func){ 
            
            //("C:/..", "wow.txt", "nice!" OR ["nice!", [0, 0, 0000]], true OR false, function(){ })
            
            var Rname = nameFile(lnk, name)
            if(Rname == undefined){ 
                return;
            }
            
            
            
            
            if(filePath.type(lnk) !== "File folder"){ 
                consoleMessage(lnk + '\nis not a folder! (createFile)', 'error')
                return;
            }
            
            var v = value || undefined
            
            if(filePath.type(name) !== "File folder"){ 
                
                if(alldata){ 
                    FILEDATA.push(v)
                }
                else{ 
                    FILEDATA.push([v, getDateArray()])
                }
                
                filePath.data(lnk)[Rname] = FILEDATA[FILEDATA.length - 1]
                
            }
            else{ 
                filePath.data(lnk)[Rname] = value || { }
            }
            
            
            
            consoleMessage('Creating ' + filePath.type(name).toUpperCase() + ' file in \n' + lnk)
            
            if(func){ func()}
            
            saveOS()
        }
        
        
        function renameFile(lnk, name, func){ 
            
            if(filePath.alldata(lnk) == undefined){ 
                openFile('C:/Windows/Base/Popup/Popup.exe', ['C:/Windows/Base/Popup/context.dat', 'The file you want to rename does not exist', 'error', null, null])
                return;
            }
            
            
            var old_key = lnk.split('/')[lnk.split('/').length -1]
            var old_type = filePath.type(old_key)
            
            var obj = filePath.folder(lnk)
            var fol = obj
            obj = filePath.data(obj)
            
            var new_key = name
            
            
            
            
            function renAm(){ 
                if(nameFile(fol, name) == undefined){ 
                    return;
                }
                if(old_key !== name){ 
                    Object.defineProperty(obj, nameFile(fol, name),
                        Object.getOwnPropertyDescriptor(obj, old_key));
                    delete obj[old_key];
                }
                if(func){ func()}
            }
            
            if(name.split('.')[1] == undefined && old_type !== "File folder"){ 
                name += '.' + old_type
                renAm()
            }
            else{ 
                if(filePath.type(name) !== old_type){ 
                    openFile('C:/Windows/Base/Popup/Popup.exe', 
                    ['C:/Windows/Base/Popup/context.dat', 'If you change a file name extension, the file might become unusable. Are you sure you want to change it?', 'warning',
                    
                    function(){ 
                        return;
                    },
                    
                    function(){ 
                        renAm()
                    }
                    ])
                }
                else{ 
                    renAm()
                }
            }
            
            
            saveOS()
        }
        
        
        function loadCSS(lnk, func){ 
            var n = filePath.formattedName(lnk)
            if($('style.' + n).length == 0){ 
                $('head').append('<style class="' + n + '">' + filePath.data(lnk) + '</style>')
                
            }
            else{ 
                $('style.' + n).empty().append(filePath.data(lnk))
            }
            
            if(func){ func()}
        }
        
        
        function saveOS(func){ 
            localStorage.clear()
            localStorage.setItem('savedFILESYSTEM', JSON.stringify(FILESYSTEM, function(key, value) { 
            if (typeof value === 'function') { 
                return '(#*^' + value.toString();
            }
            else { 
                return value;
            }
}));
            
            consoleMessage('Saved OS in localStorage')
            if(func){ func()}
        }
        
        
        function loadSavedOS(func){ 
            if(localStorage.getItem('savedFILESYSTEM')){ 
                FILESYSTEM = JSON.parse(localStorage.getItem('savedFILESYSTEM'), function(key, value){ 
                    if(typeof value == 'string'){ 
                        if(value.slice(0, 4) === "(#*^"){ 
                            value = value.substring(4)
                            return eval('(' + value + ')')
                        }
                    }
                    return value
                })
                
                consoleMessage('Loaded saved OS')
            }
            else{ 
                consoleMessage('Did not load OS because it is not saved')
            }
            
            if(func){ func()}
        }
        
        
        function reinstallOS(func){ 
            localStorage.clear()
            consoleMessage('Cleared saved OS')
            if(func){ func()}
        }
        
        
    </script><!--File System-->
    
    
    
</html>
